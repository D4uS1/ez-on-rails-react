"use strict";var We=Object.create;var K=Object.defineProperty;var Xe=Object.getOwnPropertyDescriptor;var Je=Object.getOwnPropertyNames;var Ze=Object.getPrototypeOf,Ke=Object.prototype.hasOwnProperty;var Qe=(e,r)=>{for(var a in r)K(e,a,{get:r[a],enumerable:!0})},pe=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Je(r))!Ke.call(e,s)&&s!==a&&K(e,s,{get:()=>r[s],enumerable:!(n=Xe(r,s))||n.enumerable});return e};var C=(e,r,a)=>(a=e!=null?We(Ze(e)):{},pe(r||!e||!e.__esModule?K(a,"default",{value:e,enumerable:!0}):a,e)),er=e=>pe(K({},"__esModule",{value:!0}),e);var fr={};Qe(fr,{ActiveStorageDropzone:()=>oe,DevelopmentHint:()=>Le,EzOnRails:()=>be,EzOnRailsHttp:()=>ur,EzOnRailsHttpError:()=>G,EzOnRailsIntegrations:()=>cr,LoginForm:()=>Re,LostPasswordForm:()=>ke,ProtectedPage:()=>Ve,RegistrationForm:()=>ze,ResendConfirmationForm:()=>Ie,ResetPasswordForm:()=>Me,UpdateUserForm:()=>qe,useEzApi:()=>we,useEzApiHttpClient:()=>ne,useEzOnRails:()=>v,useEzScaff:()=>xe});module.exports=er(fr);var _=C(require("react"));var he=require("react"),Q=(0,he.createContext)({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{}});var be=e=>{let[r,a]=(0,_.useState)(e.backendUrl),[n,s]=(0,_.useState)(e.authInfo||null),[o,d]=(0,_.useState)(e.apiVersion),[p,i]=(0,_.useState)(()=>e.onUnauthorizedCallback),l=(0,_.useCallback)(P=>{i(()=>P)},[]),h=(0,_.useMemo)(()=>{let P={backendUrl:r,authInfo:n||null,apiVersion:o,setBackendUrl:a,setAuthInfo:s,setApiVersion:d,setOnUnauthorizedCallback:l,onUnauthorizedCallback:p};return P.backendUrl.endsWith("/")&&(P.backendUrl=P.backendUrl.slice(0,-1)),P},[r,n,o,l,p]);return _.default.createElement(Q.Provider,{value:h},e.children)};var E=C(require("react")),B=C(require("yup")),ve=require("formik");var $=require("react");var Te=require("react");var ae=require("convert-keys");var G=class extends Error{constructor(r,a){super(),this.message=r,this.httpStatusCode=a}};var le=e=>e.startsWith("/")?e.slice(1):e,me=e=>e.endsWith("/")?e.slice(0,-1):e,rr=(e,r)=>`${me(e)}/${le(r)}`,ar=(e,r)=>`${me(e)}/api/${le(r)}`,nr=e=>(e=e.replace(/[A-Z]/g,(r,a)=>a===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),Ee=e=>e&&(0,ae.toSnake)(e),Ce=e=>e&&(0,ae.toCamel)(e),tr=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),ee=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>ee(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=ee(e[r])}),e),re=e=>e instanceof Date?e.toISOString():Array.isArray(e)?e.map(r=>re(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=re(e[r])}),e),sr=e=>re(Ee(e)),or=e=>!e||typeof e!="object"?e:ee(Ce(e)),ir=e=>e?e instanceof G:!1,m={cleanupUrl:me,cleanupPath:le,toBaseUrl:rr,toApiUrl:ar,toSnakeCase:Ee,toSnakeCasePath:nr,toCamelCase:Ce,toGetParameters:tr,toDates:ee,toDateStrings:re,toBackendParams:sr,toFrontendParams:or,isEzOnRailsHttpError:ir};var lr=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},mr=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),U=(e,r)=>({"Content-Type":"application/json",Accept:"application/json","api-version":r,...lr(e)}),L=async(e,r,a,n)=>{let s=await fetch(r,{method:e,headers:n,body:a?JSON.stringify(a):null});if(!s.ok)throw new G(await s.text(),s.status);let o={},d=null;try{s.headers.forEach((p,i)=>{o[i]=p}),d=await s.json()}catch{}return{headers:o,body:d}},c={signUp:async(e,r,a)=>{r=m.toBackendParams(r),await L("POST",m.toBaseUrl(e,"users"),{user:r},U(null,a))},signIn:async(e,r,a)=>{r=m.toBackendParams(r);let n=await L("POST",m.toApiUrl(e,"auth/sign_in"),r,U(null,a));return mr(n.headers)},signOut:async(e,r,a)=>{await L("DELETE",m.toApiUrl(e,"auth/sign_out"),null,U(r,a))},passwordResetInstructions:async(e,r,a)=>{r=m.toBackendParams(r),await L("POST",m.toBaseUrl(e,"users/password"),{user:r},U(null,a))},passwordReset:async(e,r,a)=>{r=m.toBackendParams(r),await L("PUT",m.toBaseUrl(e,"users/password"),{user:r},U(null,a))},getUser:async(e,r,a)=>{let n=await L("GET",m.toApiUrl(e,"users/me"),null,U(r,a));return m.toFrontendParams(n.body)},updateUser:async(e,r,a,n)=>{let s=r.avatar?.signedId,o={...m.toBackendParams(r),avatar:s},d=await L("PATCH",m.toApiUrl(e,"users/me"),{user:o},U(a,n));return m.toFrontendParams(d.body)},confirmationInstructions:async(e,r,a)=>{r=m.toBackendParams(r),await L("POST",m.toBaseUrl(e,"users/confirmation"),{user:r},U(null,a))},confirmation:async(e,r,a)=>{let n=m.toBaseUrl(e,"users/confirmation");r=m.toBackendParams(r),n=`${n}?${m.toGetParameters(r)}`,await L("GET",n,null,U(null,a))},get:async(e,r,a,n=null,s="1.0",o=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),o&&(a=o(a)),a&&(d=`${d}?${m.toGetParameters(a)}`);let p=await L("GET",d,null,U(n,s));return m.toFrontendParams(p.body)},post:async(e,r,a,n=null,s="1.0",o=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),o&&(a=o(a));let p=await L("POST",d,a,U(n,s));return m.toFrontendParams(p.body)},patch:async(e,r,a,n=null,s="1.0",o=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),o&&(a=o(a));let p=await L("PATCH",d,a,U(n,s));return m.toFrontendParams(p.body)},put:async(e,r,a,n=null,s="1.0",o=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),o&&(a=o(a));let p=await L("PUT",d,a,U(n,s));return m.toFrontendParams(p.body)},delete:async(e,r,a,n=null,s="1.0",o=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),o&&(a=o(a)),a&&(d=`${d}?${m.toGetParameters(a)}`);let p=await L("DELETE",d,null,U(n,s));return m.toFrontendParams(p.body)},defaultHttpHeader:(e,r)=>U(e,r)};var Pe=require("react");var v=()=>(0,Pe.useContext)(Q);var ne=e=>{let{backendUrl:r,authInfo:a,apiVersion:n,onUnauthorizedCallback:s}=v();return{call:(0,Te.useCallback)(async(d,p,i)=>{let l=e?m.cleanupPath(m.cleanupUrl(e)):null,h=m.cleanupPath(d),P=`${l?l+"/":""}${h}`;try{switch(p){case"POST":return await c.post(r,P,i,a,n);case"PUT":return await c.put(r,P,i,a,n);case"PATCH":return await c.patch(r,P,i,a,n);case"DELETE":return await c.delete(r,P,i,a,n);default:return await c.get(r,P,i,a,n)}}catch(x){if(!m.isEzOnRailsHttpError(x)||x.httpStatusCode!==401||!s)throw x;return s(),null}},[a,n,r,e,s])}};var we=(e,r="GET",a,n)=>{let[s,o]=(0,$.useState)(null),[d,p]=(0,$.useState)(null),[i,l]=(0,$.useState)(!1),{call:h}=ne(),P=(0,$.useCallback)(async x=>{try{l(!0),p(null),o(null);let f=await h(e,r,x||a);return o(f),l(!1),f}catch(f){p(f),l(!1)}},[e,h,a,r]);return(0,$.useEffect)(()=>{(async()=>n?.skipInitialCall||await P())()},[P,n]),{data:s,error:d,inProgress:i,callApi:P}};var I=require("react");var xe=e=>{let{backendUrl:r,authInfo:a,apiVersion:n}=v(),[s,o]=(0,I.useState)(null),[d,p]=(0,I.useState)(null),[i,l]=(0,I.useState)(!1),[h,P]=(0,I.useState)(null),x=(0,I.useMemo)(()=>m.toSnakeCasePath(e),[e]),f=(0,I.useCallback)(async T=>{P(null),l(!0);try{let y=await T();return l(!1),y}catch(y){return l(!1),P(y),null}},[]),O=(0,I.useCallback)(()=>f(async()=>{let T=await c.get(r,x,null,a,n);return p(T),T}),[r,a,n,x,f]),u=(0,I.useCallback)(T=>f(async()=>{let y=await c.get(r,`${x}/${T}`,null,a,n);return o(y),y}),[r,a,n,x,f]),b=(0,I.useCallback)(T=>f(async()=>{let y=await c.get(r,x,T,a,n);return p(y),y}),[r,a,n,x,f]),k=(0,I.useCallback)(T=>f(async()=>{let y=await c.post(r,x,T,a,n);return o(y),y}),[r,a,n,x,f]),A=(0,I.useCallback)((T,y)=>f(async()=>{let ge=await c.patch(r,`${x}/${T}`,y,a,n);return o(ge),ge}),[r,a,n,x,f]),S=(0,I.useCallback)(T=>f(async()=>{await c.delete(r,`${x}/${T}`,null,a,n),o(null)}),[r,a,n,x,f]);return{record:s,records:d,inProgress:i,error:h,getAll:O,getOne:u,search:b,create:k,update:A,remove:S}};var F=require("react-bootstrap");var t={container:"Form-module__container_7Xp4fa__090",fieldContainer:"Form-module__fieldContainer_7Xp4fa__090",fieldLabel:"Form-module__fieldLabel_7Xp4fa__090"};var ze=e=>{let{backendUrl:r,apiVersion:a}=v(),[n,s]=(0,E.useState)(!1),o=async i=>{s(!0);try{await c.signUp(r,i,a),e.onRegisterSuccess(i.email),s(!1)}catch(l){e.onRegisterError(l),s(!1)}},d=B.object().shape({username:B.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:B.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:B.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:B.string().oneOf([B.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:B.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return E.default.createElement(ve.Formik,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:d,onSubmit:i=>{o(i)}},({errors:i,handleChange:l,handleSubmit:h})=>E.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},E.default.createElement(F.Form.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},E.default.createElement(F.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),E.default.createElement(F.Form.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",onChange:l,isInvalid:!!i.username}),E.default.createElement(F.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},i.username)),E.default.createElement(F.Form.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},E.default.createElement(F.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),E.default.createElement(F.Form.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",onChange:l,isInvalid:!!i.email}),E.default.createElement(F.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},i.email)),E.default.createElement(F.Form.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},E.default.createElement(F.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),E.default.createElement(F.Form.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",onChange:l,isInvalid:!!i.password}),E.default.createElement(F.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},i.password)),E.default.createElement(F.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},E.default.createElement(F.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),E.default.createElement(F.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",onChange:l,isInvalid:!!i.passwordConfirmation}),E.default.createElement(F.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},i.passwordConfirmation)),E.default.createElement(F.Form.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},E.default.createElement(F.Form.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||E.default.createElement("span",null,"I have read and accept the"," ",E.default.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",E.default.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:l,isInvalid:!!i.privacyPolicyAccepted,feedbackType:"invalid",feedback:i.privacyPolicyAccepted})),!n&&E.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},E.default.createElement(F.Button,{className:e.submitButtonClassName||t.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};var Fe=require("formik"),H=C(require("react-bootstrap/Form")),ye=C(require("react-bootstrap/Button")),R=C(require("react")),W=C(require("yup"));var Re=e=>{let{backendUrl:r,apiVersion:a,setAuthInfo:n}=v(),[s,o]=(0,R.useState)(!1),d=W.object().shape({email:W.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:W.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),p=async l=>{o(!0);try{let h=await c.signIn(r,l,a);if(!h)throw"No authentication object returned";if(n(h),!e.onLoginSuccess)return;await e.onLoginSuccess(l.email,h,l.stayLoggedIn)}catch(h){e.onLoginError(h),o(!1)}};return R.default.createElement(Fe.Formik,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:l=>{p(l)},validationSchema:d},({errors:l,handleChange:h,handleSubmit:P})=>R.default.createElement("form",{onSubmit:P,className:e.containerClassName||t.container},R.default.createElement(H.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},R.default.createElement(H.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),R.default.createElement(H.default.Control,{id:"email",type:"email",onChange:h,className:e.fieldInputClassName||t.formField,isInvalid:!!l.email}),R.default.createElement(H.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},l.email)),R.default.createElement(H.default.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},R.default.createElement(H.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),R.default.createElement(H.default.Control,{id:"password",type:"password",onChange:h,className:e.fieldInputClassName||t.formField,isInvalid:!!l.password}),R.default.createElement(H.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},l.password)),!e.hideStayLoggedIn&&R.default.createElement(H.default.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},R.default.createElement(H.default.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:h})),!s&&R.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},R.default.createElement(ye.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Login"))))};var M=C(require("react")),te=C(require("yup"));var Ne=require("formik"),X=C(require("react-bootstrap/Form")),Oe=C(require("react-bootstrap/Button"));var ke=e=>{let{backendUrl:r,apiVersion:a}=v(),[n,s]=(0,M.useState)(!1),o=te.object().shape({email:te.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),d=i=>{s(!0),c.passwordResetInstructions(r,i,a).then(()=>{e.onLostPasswordSuccess(i.email),s(!1)}).catch(l=>{e.onLostPasswordError(l),s(!1)})};return M.default.createElement(Ne.Formik,{initialValues:{email:""},onSubmit:i=>{d(i)},validationSchema:o},({errors:i,handleChange:l,handleSubmit:h})=>M.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},M.default.createElement(X.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},M.default.createElement(X.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),M.default.createElement(X.default.Control,{id:"email",type:"email",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!i.email}),M.default.createElement(X.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},i.email)),!n&&M.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},M.default.createElement(Oe.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var V=C(require("react")),se=C(require("yup"));var Se=require("formik"),J=C(require("react-bootstrap/Form")),Ue=C(require("react-bootstrap/Button"));var Ie=e=>{let{backendUrl:r,apiVersion:a}=v(),[n,s]=(0,V.useState)(!1),o=se.object().shape({email:se.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),d=i=>{s(!0),c.confirmationInstructions(r,i,a).then(()=>{e.onResendConfirmationSuccess(i.email),s(!1)}).catch(l=>{e.onResendConfirmationError(l),s(!1)})};return V.default.createElement(Se.Formik,{initialValues:{email:""},onSubmit:i=>{d(i)},validationSchema:o},({errors:i,handleChange:l,handleSubmit:h})=>V.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},V.default.createElement(J.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},V.default.createElement(J.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),V.default.createElement(J.default.Control,{id:"email",type:"email",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!i.email}),V.default.createElement(J.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},i.email)),!n&&V.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},V.default.createElement(Ue.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var Z=C(require("react"));var de={container:"DevelopmentHint-module__container_wJV76G__090",text:"DevelopmentHint-module__text_wJV76G__090"};var Le=e=>{let[r,a]=(0,Z.useState)(e.visible),n=()=>{a(!0)};return r?Z.default.createElement("div",{onClick:()=>{a(!1),setTimeout(n,e.dismissTimeout||2e4)},className:de.container},Z.default.createElement("span",{className:de.text},"development")):null};var w=C(require("react")),Ae=C(require("@rails/activestorage")),_e=require("react"),j=C(require("react-dropzone"));var ue={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__090",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__090"};var dr=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,oe=e=>{let{backendUrl:r,authInfo:a,apiVersion:n}=v(),[s,o]=(0,_e.useState)(0),d=w.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},w.default.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),w.default.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),p=async u=>{await c.delete(r,`active_storage/blobs/${u}`,null,a,n)},i=async(u,b)=>{await p(b);let k=[...e.files];k=k.filter(A=>b!==A.signedId),e.onChange(k),u.stopPropagation()},l=u=>{u.loaded/u.total>=.9999999},h=u=>{if(u.length){if(e.maxFiles){let b=e.maxFiles-(e.files.length+s);if(b<u.length&&e.onMaxFilesError(e.maxFiles),b<=0)return;u=u.slice(0,b)}if(e.maxSize){let b=u.filter(k=>k.size<=e.maxSize);b.length<u.length&&e.onMaxSizeError(e.maxSize),u=b}o(b=>b+u.length),u.forEach(b=>{new Ae.DirectUpload(b,m.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:A=>{let S=c.defaultHttpHeader(a,n);Object.keys(S).forEach(T=>{A.setRequestHeader(T,S[T])}),A.upload.addEventListener("progress",l)}}).create((A,S)=>{if(o(T=>T-1),!A){let T={signedId:S.signed_id};b.type.includes("image")?T.path=dr(S.signed_id,S.filename):T.filename=S.filename;let y=e.files;y.push(T),e.onChange([...y])}})})}},P=u=>{if(!u.clipboardData)return;let b=u.clipboardData.items;if(b===void 0)return;let k=[];for(let A of b){if(e.accept&&!Object.keys(e.accept).some(T=>A.type.match(T)))continue;let S=A.getAsFile();S&&k.push(S)}h(k)},x=e.files.map(u=>w.default.createElement("div",{key:u.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"card-header p-1"},w.default.createElement("button",{onClick:b=>i(b,u.signedId||""),type:"button",className:"close","aria-label":"Close"},w.default.createElement("span",{"aria-hidden":"true"},"\xD7"))),w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.default.createElement("img",{src:m.toBaseUrl(r,u.path||""),alt:u.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"})))),f=[];for(let u=0;u<s;u++)f.push(w.default.createElement("div",{key:u,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.default.createElement("div",{className:"p-4 text-center"},w.default.createElement("div",{className:"spinner-border",role:"status"},w.default.createElement("span",{className:"sr-only"},"Loading..."))))));let O=u=>{u.some(b=>b.errors[0].code===j.ErrorCode.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),u.some(b=>b.errors[0].code===j.ErrorCode.FileInvalidType)&&e.onInvalidTypeError(e.accept),u.some(b=>b.errors[0].code===j.ErrorCode.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return w.default.createElement("div",null,e.pasteZone&&w.default.createElement("input",{type:"text",className:`w-100 p-2 ${ue.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:P,readOnly:!0}),w.default.createElement(j.default,{onDropAccepted:h,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:O,accept:e.accept},({getRootProps:u,getInputProps:b})=>w.default.createElement("section",null,w.default.createElement("div",{...u(),className:`${ue.dropzoneContainer} p-4 ${e.className}`},w.default.createElement("input",{...b()}),w.default.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),x.length>0?w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},x):w.default.createElement("div",{className:"m-0"},e.customIcon||d),f.length>0&&w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},f)))))};var Be=require("formik"),D=C(require("react-bootstrap/Form")),He=C(require("react-bootstrap/Button")),N=C(require("react")),Y=C(require("yup"));var Me=e=>{let{backendUrl:r,apiVersion:a}=v(),[n,s]=(0,N.useState)(!1),o=Y.object().shape({password:Y.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:Y.string().oneOf([Y.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.")}).defined(),d=(0,N.useCallback)(async i=>{s(!0);try{await c.passwordReset(r,{...i,resetPasswordToken:e.resetPasswordToken},a),await e.onResetPasswordSuccess()}catch(l){e.onResetPasswordError(l),s(!1)}},[e,r,a]);return N.default.createElement(Be.Formik,{initialValues:{password:"",passwordConfirmation:""},onSubmit:i=>{d(i)},validationSchema:o},({errors:i,handleChange:l,handleSubmit:h})=>N.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},N.default.createElement(D.default.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},N.default.createElement(D.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),N.default.createElement(D.default.Control,{id:"password",type:"password",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!i.password}),N.default.createElement(D.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},i.password)),N.default.createElement(D.default.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},N.default.createElement(D.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),N.default.createElement(D.default.Control,{id:"passwordConfirmation",type:"password",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!i.passwordConfirmation}),N.default.createElement(D.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},i.passwordConfirmation)),!n&&N.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},N.default.createElement(He.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var ce=C(require("react"));var Ve=e=>{let{authInfo:r}=v();return ce.default.createElement("div",null,r?e.children:ce.default.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};var g=C(require("react")),q=C(require("yup")),De=require("formik");var z=require("react-bootstrap");var qe=e=>{let{authInfo:r,backendUrl:a,apiVersion:n}=v(),[s,o]=(0,g.useState)(!1),[d,p]=(0,g.useState)(null),[i,l]=(0,g.useState)(void 0),h=f=>{p(f),l(f.unconfirmedEmail)};(0,g.useEffect)(()=>{(async()=>r&&h(await c.getUser(a,r,n)))()},[a,r,n]);let P=async f=>{if(r){o(!0);try{let O=await c.updateUser(a,f,r,n);e.onUserUpdateSuccess(O),h(O),o(!1)}catch(O){e.onUserUpdateError(O),o(!1)}}},x=q.object().shape({username:q.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:q.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:q.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:q.string().oneOf([q.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&g.default.createElement("div",{className:"ez-on-rails-form-outer-container"},d?g.default.createElement(De.Formik,{initialValues:d,validationSchema:x,enableReinitialize:!0,onSubmit:f=>{P(f)}},({errors:f,values:O,handleChange:u,setFieldValue:b,setFieldError:k,handleSubmit:A})=>g.default.createElement("form",{onSubmit:A,className:e.containerClassName||t.container},!e.hideUsername&&g.default.createElement(z.Form.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},g.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),g.default.createElement(z.Form.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",value:O.username,onChange:u,isInvalid:!!f.username}),g.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.username)),!e.hideEmail&&g.default.createElement(z.Form.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},g.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),g.default.createElement(z.Form.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",value:O.email,onChange:u,isInvalid:!!f.email}),i&&g.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",i),g.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.email)),!e.hidePassword&&g.default.createElement(z.Form.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},g.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),g.default.createElement(z.Form.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",value:O.password,onChange:u,isInvalid:!!f.password}),g.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),g.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.password)),!e.hidePassword&&g.default.createElement(z.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},g.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),g.default.createElement(z.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",value:O.passwordConfirmation,onChange:u,isInvalid:!!f.passwordConfirmation}),g.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.passwordConfirmation)),!e.hideAvatar&&g.default.createElement(z.Form.Group,{id:"avatar-container",className:e.fieldContainerClassName||t.fieldContainer},g.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelAvatar||"Avatar"),g.default.createElement("div",{className:e.dropzoneContainerClassName||t.formField},g.default.createElement(oe,{onChange:S=>b("avatar",S.length>0?S[0]:null),files:O.avatar?[O.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>k("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>k("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>k("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),g.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.avatar)),!s&&g.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},g.default.createElement(z.Button,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit")))):g.default.createElement("div",null,"Loading..."))};var Ge={fetcher:async([e,r,a="get",n=null,s=void 0,o="1.0"])=>{switch(a=a.toLowerCase(),a){case"post":return c.post(e,r,n,s,o);case"put":return c.put(e,r,n,s,o);case"patch":return c.patch(e,r,n,s,o);case"delete":return c.delete(e,r,n,s,o);default:return c.get(e,r,n,s,o)}}};var ur={client:c,swr:Ge,utils:m};var $e=require("@d4us1/remawy"),Ye=C(require("@rails/activestorage")),fe=class{constructor(r,a,n){this.uploader=r,this.authInfo=a,this.apiVersion=n}directUploadWillCreateBlobWithXHR(r){let a=c.defaultHttpHeader(this.authInfo,this.apiVersion);Object.keys(a).forEach(n=>{r.setRequestHeader(n,a[n])}),r.upload.addEventListener("progress",n=>this.uploader.onDirectUploadProgress(n))}},ie=class extends $e.AbstractUploader{constructor(r,a,n){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=a,this.apiVersion=n}startUpload(r){let a=new fe(this,this.authInfo,this.apiVersion);return new Ye.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,a).create((s,o)=>{if(s)this.onError(s);else{let d=`${this.baseUrl}rails/active_storage/blobs/${o.signed_id}/${o.filename}`,p={signedId:o.signed_id,fileName:o.filename};this.onFinish(d,r,p)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var je={uploader:ie};var cr={remawy:je};
//# sourceMappingURL=index.js.map
