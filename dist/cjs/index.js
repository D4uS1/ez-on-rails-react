"use strict";var Xe=Object.create;var Q=Object.defineProperty;var Ke=Object.getOwnPropertyDescriptor;var Je=Object.getOwnPropertyNames;var Ze=Object.getPrototypeOf,Qe=Object.prototype.hasOwnProperty;var er=(e,r)=>{for(var n in r)Q(e,n,{get:r[n],enumerable:!0})},he=(e,r,n,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Je(r))!Qe.call(e,s)&&s!==n&&Q(e,s,{get:()=>r[s],enumerable:!(a=Ke(r,s))||a.enumerable});return e};var P=(e,r,n)=>(n=e!=null?Xe(Ze(e)):{},he(r||!e||!e.__esModule?Q(n,"default",{value:e,enumerable:!0}):n,e)),rr=e=>he(Q({},"__esModule",{value:!0}),e);var pr={};er(pr,{ActiveStorageDropzone:()=>ie,DevelopmentHint:()=>Ae,EzOnRails:()=>Ee,EzOnRailsHttp:()=>fr,EzOnRailsHttpError:()=>$,EzOnRailsIntegrations:()=>gr,LoginForm:()=>Ne,LostPasswordForm:()=>Se,ProtectedPage:()=>De,RegistrationForm:()=>ye,ResendConfirmationForm:()=>Le,ResetPasswordForm:()=>Ve,UpdateUserForm:()=>Ge,useEzApi:()=>xe,useEzApiHttpClient:()=>te,useEzOnRails:()=>x,useEzScaff:()=>ve});module.exports=rr(pr);var _=P(require("react"));var be=require("react"),ee=(0,be.createContext)({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,apiKey:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiKey:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{}});var Ee=e=>{let[r,n]=(0,_.useState)(e.backendUrl),[a,s]=(0,_.useState)(e.authInfo||null),[i,l]=(0,_.useState)(e.apiVersion),[f,o]=(0,_.useState)(e.apiKey||null),[m,h]=(0,_.useState)(()=>e.onUnauthorizedCallback),y=(0,_.useCallback)(u=>{h(()=>u)},[]),O=(0,_.useMemo)(()=>{let u={backendUrl:r,authInfo:a||null,apiKey:f||null,apiVersion:i,setBackendUrl:n,setAuthInfo:s,setApiKey:o,setApiVersion:l,setOnUnauthorizedCallback:y,onUnauthorizedCallback:m};return u.backendUrl.endsWith("/")&&(u.backendUrl=u.backendUrl.slice(0,-1)),u},[r,a,f,i,y,m]);return _.default.createElement(ee.Provider,{value:O},e.children)};var C=P(require("react")),B=P(require("yup")),ze=require("formik");var Y=require("react");var we=require("react");var ae=require("convert-keys");var $=class extends Error{constructor(r,n){super(),this.message=r,this.httpStatusCode=n}};var me=e=>e.startsWith("/")?e.slice(1):e,de=e=>e.endsWith("/")?e.slice(0,-1):e,nr=(e,r)=>`${de(e)}/${me(r)}`,ar=(e,r)=>`${de(e)}/api/${me(r)}`,tr=e=>(e=e.replace(/[A-Z]/g,(r,n)=>n===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),Ce=e=>e&&(0,ae.toSnake)(e),Pe=e=>e&&(0,ae.toCamel)(e),sr=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),re=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>re(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=re(e[r])}),e),ne=e=>e instanceof Date?e.toISOString():Array.isArray(e)?e.map(r=>ne(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=ne(e[r])}),e),or=e=>ne(Ce(e)),ir=e=>!e||typeof e!="object"?e:re(Pe(e)),lr=e=>e?e instanceof $:!1,d={cleanupUrl:de,cleanupPath:me,toBaseUrl:nr,toApiUrl:ar,toSnakeCase:Ce,toSnakeCasePath:tr,toCamelCase:Pe,toGetParameters:sr,toDates:re,toDateStrings:ne,toBackendParams:or,toFrontendParams:ir,isEzOnRailsHttpError:lr};var mr=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},dr=e=>{if(e)return{"api-key":e}},ur=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),k=(e,r,n)=>({"Content-Type":"application/json",Accept:"application/json","api-version":n,...dr(r),...mr(e)}),I=async(e,r,n,a)=>{let s=await fetch(r,{method:e,headers:a,body:n?JSON.stringify(n):null});if(!s.ok)throw new $(await s.text(),s.status);let i={},l=null;try{s.headers.forEach((f,o)=>{i[o]=f}),l=await s.json()}catch{}return{headers:i,body:l}},c={signUp:async(e,r,n)=>{r=d.toBackendParams(r),await I("POST",d.toBaseUrl(e,"users"),{user:r},k(null,null,n))},signIn:async(e,r,n)=>{r=d.toBackendParams(r);let a=await I("POST",d.toApiUrl(e,"auth/sign_in"),r,k(null,null,n));return ur(a.headers)},signOut:async(e,r,n)=>{await I("DELETE",d.toApiUrl(e,"auth/sign_out"),null,k(r,null,n))},passwordResetInstructions:async(e,r,n)=>{r=d.toBackendParams(r),await I("POST",d.toBaseUrl(e,"users/password"),{user:r},k(null,null,n))},passwordReset:async(e,r,n)=>{r=d.toBackendParams(r),await I("PUT",d.toBaseUrl(e,"users/password"),{user:r},k(null,null,n))},getUser:async(e,r,n)=>{let a=await I("GET",d.toApiUrl(e,"users/me"),null,k(r,null,n));return d.toFrontendParams(a.body)},updateUser:async(e,r,n,a)=>{let s=r.avatar?.signedId,i={...d.toBackendParams(r),avatar:s},l=await I("PATCH",d.toApiUrl(e,"users/me"),{user:i},k(n,null,a));return d.toFrontendParams(l.body)},confirmationInstructions:async(e,r,n)=>{r=d.toBackendParams(r),await I("POST",d.toBaseUrl(e,"users/confirmation"),{user:r},k(null,null,n))},confirmation:async(e,r,n)=>{let a=d.toBaseUrl(e,"users/confirmation");r=d.toBackendParams(r),a=`${a}?${d.toGetParameters(r)}`,await I("GET",a,null,k(null,null,n))},get:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let f=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(f=`${f}?${d.toGetParameters(n)}`);let o=await I("GET",f,null,k(a,s,i));return d.toFrontendParams(o.body)},post:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let f=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await I("POST",f,n,k(a,s,i));return d.toFrontendParams(o.body)},patch:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let f=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await I("PATCH",f,n,k(a,s,i));return d.toFrontendParams(o.body)},put:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let f=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await I("PUT",f,n,k(a,s,i));return d.toFrontendParams(o.body)},delete:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let f=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(f=`${f}?${d.toGetParameters(n)}`);let o=await I("DELETE",f,null,k(a,s,i));return d.toFrontendParams(o.body)},defaultHttpHeader:(e,r,n)=>k(e,r,n)};var Te=require("react");var x=()=>(0,Te.useContext)(ee);var te=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s,onUnauthorizedCallback:i}=x();return{call:(0,we.useCallback)(async(f,o,m)=>{let h=e?d.cleanupPath(d.cleanupUrl(e)):null,y=d.cleanupPath(f),O=`${h?h+"/":""}${y}`;try{switch(o){case"POST":return await c.post(r,O,m,n,a,s);case"PUT":return await c.put(r,O,m,n,a,s);case"PATCH":return await c.patch(r,O,m,n,a,s);case"DELETE":return await c.delete(r,O,m,n,a,s);default:return await c.get(r,O,m,n,a,s)}}catch(u){if(!d.isEzOnRailsHttpError(u)||u.httpStatusCode!==401||!i)throw u;return i(),null}},[n,a,s,r,e,i])}};var xe=(e,r="GET",n,a)=>{let[s,i]=(0,Y.useState)(null),[l,f]=(0,Y.useState)(null),[o,m]=(0,Y.useState)(!1),{call:h}=te(),y=(0,Y.useCallback)(async O=>{try{m(!0),f(null),i(null);let u=await h(e,r,O||n);return i(u),m(!1),u}catch(u){f(u),m(!1)}},[e,h,n,r]);return(0,Y.useEffect)(()=>{(async()=>a?.skipInitialCall||await y())()},[y,a]),{data:s,error:l,inProgress:o,callApi:y}};var S=require("react");var ve=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s}=x(),[i,l]=(0,S.useState)(null),[f,o]=(0,S.useState)(null),[m,h]=(0,S.useState)(!1),[y,O]=(0,S.useState)(null),u=(0,S.useMemo)(()=>d.toSnakeCasePath(e),[e]),E=(0,S.useCallback)(async T=>{O(null),h(!0);try{let F=await T();return h(!1),F}catch(F){return h(!1),O(F),null}},[]),G=(0,S.useCallback)(()=>E(async()=>{let T=await c.get(r,u,null,n,a,s);return o(T),T}),[r,n,a,s,u,E]),g=(0,S.useCallback)(T=>E(async()=>{let F=await c.get(r,`${u}/${T}`,null,n,a,s);return l(F),F}),[r,n,a,s,u,E]),b=(0,S.useCallback)(T=>E(async()=>{let F=await c.post(r,`${u}/search`,T,n,a,s);return o(F),F}),[r,n,a,s,u,E]),L=(0,S.useCallback)(T=>E(async()=>{let F=await c.post(r,u,T,n,a,s);return l(F),F}),[r,n,a,s,u,E]),U=(0,S.useCallback)((T,F)=>E(async()=>{let pe=await c.patch(r,`${u}/${T}`,F,n,a,s);return l(pe),pe}),[r,n,a,s,u,E]),A=(0,S.useCallback)(T=>E(async()=>{await c.delete(r,`${u}/${T}`,null,n,a,s),l(null)}),[r,n,a,s,u,E]);return{record:i,records:f,inProgress:m,error:y,getAll:G,getOne:g,search:b,create:L,update:U,remove:A}};var z=require("react-bootstrap");var t={container:"Form-module__container_7Xp4fa__120",fieldContainer:"Form-module__fieldContainer_7Xp4fa__120",fieldLabel:"Form-module__fieldLabel_7Xp4fa__120"};var ye=e=>{let{backendUrl:r,apiVersion:n}=x(),[a,s]=(0,C.useState)(!1),i=async o=>{s(!0);try{await c.signUp(r,o,n),e.onRegisterSuccess(o.email),s(!1)}catch(m){e.onRegisterError(m),s(!1)}},l=B.object().shape({username:B.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:B.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:B.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:B.string().oneOf([B.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match.").required(e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:B.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.").required(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return C.default.createElement(ze.Formik,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:l,onSubmit:o=>{i(o)}},({errors:o,handleChange:m,handleSubmit:h})=>C.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},C.default.createElement(z.Form.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},C.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),C.default.createElement(z.Form.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",onChange:m,isInvalid:!!o.username}),C.default.createElement(z.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.username)),C.default.createElement(z.Form.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},C.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),C.default.createElement(z.Form.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",onChange:m,isInvalid:!!o.email}),C.default.createElement(z.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.email)),C.default.createElement(z.Form.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},C.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),C.default.createElement(z.Form.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",onChange:m,isInvalid:!!o.password}),C.default.createElement(z.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.password)),C.default.createElement(z.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},C.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),C.default.createElement(z.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",onChange:m,isInvalid:!!o.passwordConfirmation}),C.default.createElement(z.Form.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.passwordConfirmation)),C.default.createElement(z.Form.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},C.default.createElement(z.Form.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||C.default.createElement("span",null,"I have read and accept the"," ",C.default.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",C.default.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:m,isInvalid:!!o.privacyPolicyAccepted,feedbackType:"invalid",feedback:o.privacyPolicyAccepted})),!a&&C.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},C.default.createElement(z.Button,{className:e.submitButtonClassName||t.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};var Fe=require("formik"),H=P(require("react-bootstrap/Form")),Re=P(require("react-bootstrap/Button")),R=P(require("react")),X=P(require("yup"));var Ne=e=>{let{backendUrl:r,apiVersion:n,setAuthInfo:a}=x(),[s,i]=(0,R.useState)(!1),l=X.object().shape({email:X.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:X.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),f=async m=>{i(!0);try{let h=await c.signIn(r,m,n);if(!h)throw"No authentication object returned";if(a(h),!e.onLoginSuccess)return;await e.onLoginSuccess(m.email,h,m.stayLoggedIn)}catch(h){e.onLoginError(h),i(!1)}};return R.default.createElement(Fe.Formik,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:m=>{f(m)},validationSchema:l},({errors:m,handleChange:h,handleSubmit:y})=>R.default.createElement("form",{onSubmit:y,className:e.containerClassName||t.container},R.default.createElement(H.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},R.default.createElement(H.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),R.default.createElement(H.default.Control,{id:"email",type:"email",onChange:h,className:e.fieldInputClassName||t.formField,isInvalid:!!m.email}),R.default.createElement(H.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},m.email)),R.default.createElement(H.default.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},R.default.createElement(H.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),R.default.createElement(H.default.Control,{id:"password",type:"password",onChange:h,className:e.fieldInputClassName||t.formField,isInvalid:!!m.password}),R.default.createElement(H.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},m.password)),!e.hideStayLoggedIn&&R.default.createElement(H.default.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},R.default.createElement(H.default.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:h})),!s&&R.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},R.default.createElement(Re.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Login"))))};var M=P(require("react")),se=P(require("yup"));var Oe=require("formik"),K=P(require("react-bootstrap/Form")),ke=P(require("react-bootstrap/Button"));var Se=e=>{let{backendUrl:r,apiVersion:n}=x(),[a,s]=(0,M.useState)(!1),i=se.object().shape({email:se.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),l=o=>{s(!0),c.passwordResetInstructions(r,o,n).then(()=>{e.onLostPasswordSuccess(o.email),s(!1)}).catch(m=>{e.onLostPasswordError(m),s(!1)})};return M.default.createElement(Oe.Formik,{initialValues:{email:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:h})=>M.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},M.default.createElement(K.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},M.default.createElement(K.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),M.default.createElement(K.default.Control,{id:"email",type:"email",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),M.default.createElement(K.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!a&&M.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},M.default.createElement(ke.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var V=P(require("react")),oe=P(require("yup"));var Ue=require("formik"),J=P(require("react-bootstrap/Form")),Ie=P(require("react-bootstrap/Button"));var Le=e=>{let{backendUrl:r,apiVersion:n}=x(),[a,s]=(0,V.useState)(!1),i=oe.object().shape({email:oe.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),l=o=>{s(!0),c.confirmationInstructions(r,o,n).then(()=>{e.onResendConfirmationSuccess(o.email),s(!1)}).catch(m=>{e.onResendConfirmationError(m),s(!1)})};return V.default.createElement(Ue.Formik,{initialValues:{email:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:h})=>V.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},V.default.createElement(J.default.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},V.default.createElement(J.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),V.default.createElement(J.default.Control,{id:"email",type:"email",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),V.default.createElement(J.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!a&&V.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},V.default.createElement(Ie.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var Z=P(require("react"));var ue={container:"DevelopmentHint-module__container_wJV76G__120",text:"DevelopmentHint-module__text_wJV76G__120"};var Ae=e=>{let[r,n]=(0,Z.useState)(e.visible),a=()=>{n(!0)};return r?Z.default.createElement("div",{onClick:()=>{n(!1),setTimeout(a,e.dismissTimeout||2e4)},className:ue.container},Z.default.createElement("span",{className:ue.text},"development")):null};var w=P(require("react")),_e=P(require("@rails/activestorage")),Be=require("react"),W=P(require("react-dropzone"));var ce={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__120",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__120"};var cr=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,ie=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s}=x(),[i,l]=(0,Be.useState)(0),f=w.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},w.default.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),w.default.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),o=async g=>{await c.delete(r,`active_storage/blobs/${g}`,null,n,a,s)},m=async(g,b)=>{await o(b);let L=[...e.files];L=L.filter(U=>b!==U.signedId),e.onChange(L),g.stopPropagation()},h=g=>{g.loaded/g.total>=.9999999},y=g=>{if(g.length){if(e.maxFiles){let b=e.maxFiles-(e.files.length+i);if(b<g.length&&e.onMaxFilesError(e.maxFiles),b<=0)return;g=g.slice(0,b)}if(e.maxSize){let b=g.filter(L=>L.size<=e.maxSize);b.length<g.length&&e.onMaxSizeError(e.maxSize),g=b}l(b=>b+g.length),g.forEach(b=>{new _e.DirectUpload(b,d.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:U=>{let A=c.defaultHttpHeader(n,a,s);Object.keys(A).forEach(T=>{U.setRequestHeader(T,A[T])}),U.upload.addEventListener("progress",h)}}).create((U,A)=>{if(l(T=>T-1),!U){let T={signedId:A.signed_id};b.type.includes("image")?T.path=cr(A.signed_id,A.filename):T.filename=A.filename;let F=e.files;F.push(T),e.onChange([...F])}})})}},O=g=>{if(!g.clipboardData)return;let b=g.clipboardData.items;if(b===void 0)return;let L=[];for(let U of b){if(e.accept&&!Object.keys(e.accept).some(T=>U.type.match(T)))continue;let A=U.getAsFile();A&&L.push(A)}y(L)},u=e.files.map(g=>w.default.createElement("div",{key:g.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"card-header p-1"},w.default.createElement("button",{onClick:b=>m(b,g.signedId||""),type:"button",className:"close","aria-label":"Close"},w.default.createElement("span",{"aria-hidden":"true"},"\xD7"))),w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.default.createElement("img",{src:d.toBaseUrl(r,g.path||""),alt:g.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"})))),E=[];for(let g=0;g<i;g++)E.push(w.default.createElement("div",{key:g,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.default.createElement("div",{className:"p-4 text-center"},w.default.createElement("div",{className:"spinner-border",role:"status"},w.default.createElement("span",{className:"sr-only"},"Loading..."))))));let G=g=>{g.some(b=>b.errors[0].code===W.ErrorCode.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),g.some(b=>b.errors[0].code===W.ErrorCode.FileInvalidType)&&e.onInvalidTypeError(e.accept),g.some(b=>b.errors[0].code===W.ErrorCode.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return w.default.createElement("div",null,e.pasteZone&&w.default.createElement("input",{type:"text",className:`w-100 p-2 ${ce.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:O,readOnly:!0}),w.default.createElement(W.default,{onDropAccepted:y,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:G,accept:e.accept},({getRootProps:g,getInputProps:b})=>w.default.createElement("section",null,w.default.createElement("div",{...g(),className:`${ce.dropzoneContainer} p-4 ${e.className}`},w.default.createElement("input",{...b()}),w.default.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),u.length>0?w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},u):w.default.createElement("div",{className:"m-0"},e.customIcon||f),E.length>0&&w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},E)))))};var He=require("formik"),D=P(require("react-bootstrap/Form")),Me=P(require("react-bootstrap/Button")),N=P(require("react")),j=P(require("yup"));var Ve=e=>{let{backendUrl:r,apiVersion:n}=x(),[a,s]=(0,N.useState)(!1),i=j.object().shape({password:j.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:j.string().oneOf([j.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.").required(e.passwordConfirmationMatchErrorText||"The password and its confirmation must match."),resetPasswordToken:j.string().required("")}).defined(),l=(0,N.useCallback)(async o=>{s(!0);try{await c.passwordReset(r,{...o,resetPasswordToken:e.resetPasswordToken},n),await e.onResetPasswordSuccess()}catch(m){e.onResetPasswordError(m),s(!1)}},[e,r,n]);return N.default.createElement(He.Formik,{initialValues:{password:"",passwordConfirmation:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:h})=>N.default.createElement("form",{onSubmit:h,className:e.containerClassName||t.container},N.default.createElement(D.default.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},N.default.createElement(D.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),N.default.createElement(D.default.Control,{id:"password",type:"password",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.password}),N.default.createElement(D.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.password)),N.default.createElement(D.default.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},N.default.createElement(D.default.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),N.default.createElement(D.default.Control,{id:"passwordConfirmation",type:"password",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.passwordConfirmation}),N.default.createElement(D.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.passwordConfirmation)),!a&&N.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},N.default.createElement(Me.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};var fe=P(require("react"));var De=e=>{let{authInfo:r}=x();return fe.default.createElement("div",null,r?e.children:fe.default.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};var p=P(require("react")),q=P(require("yup")),qe=require("formik");var v=require("react-bootstrap");var Ge=e=>{let{authInfo:r,backendUrl:n,apiVersion:a}=x(),[s,i]=(0,p.useState)(!1),[l,f]=(0,p.useState)(null),[o,m]=(0,p.useState)(void 0),h=u=>{f(u),m(u.unconfirmedEmail)};(0,p.useEffect)(()=>{(async()=>r&&h(await c.getUser(n,r,a)))()},[n,r,a]);let y=async u=>{if(r){i(!0);try{let E=await c.updateUser(n,u,r,a);e.onUserUpdateSuccess(E),h(E),i(!1)}catch(E){e.onUserUpdateError(E),i(!1)}}},O=q.object().shape({username:q.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:q.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:q.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:q.string().oneOf([q.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&p.default.createElement("div",{className:"ez-on-rails-form-outer-container"},l?p.default.createElement(qe.Formik,{initialValues:l,validationSchema:O,enableReinitialize:!0,onSubmit:u=>{y(u)}},({errors:u,values:E,handleChange:G,setFieldValue:g,setFieldError:b,handleSubmit:L})=>p.default.createElement("form",{onSubmit:L,className:e.containerClassName||t.container},!e.hideUsername&&p.default.createElement(v.Form.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},p.default.createElement(v.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),p.default.createElement(v.Form.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",value:E.username,onChange:G,isInvalid:!!u.username}),p.default.createElement(v.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.username)),!e.hideEmail&&p.default.createElement(v.Form.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},p.default.createElement(v.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),p.default.createElement(v.Form.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",value:E.email,onChange:G,isInvalid:!!u.email}),o&&p.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",o),p.default.createElement(v.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.email)),!e.hidePassword&&p.default.createElement(v.Form.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},p.default.createElement(v.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),p.default.createElement(v.Form.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",value:E.password,onChange:G,isInvalid:!!u.password}),p.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),p.default.createElement(v.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.password)),!e.hidePassword&&p.default.createElement(v.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},p.default.createElement(v.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),p.default.createElement(v.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",value:E.passwordConfirmation,onChange:G,isInvalid:!!u.passwordConfirmation}),p.default.createElement(v.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.passwordConfirmation)),!e.hideAvatar&&p.default.createElement(v.Form.Group,{id:"avatar-container",className:e.fieldContainerClassName||t.fieldContainer},p.default.createElement(v.Form.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelAvatar||"Avatar"),p.default.createElement("div",{className:e.dropzoneContainerClassName||t.formField},p.default.createElement(ie,{onChange:U=>g("avatar",U.length>0?U[0]:null),files:E.avatar?[E.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>b("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>b("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>b("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),p.default.createElement(v.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.avatar)),!s&&p.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},p.default.createElement(v.Button,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit")))):p.default.createElement("div",null,"Loading..."))};var $e={fetcher:async([e,r,n="get",a=null,s=void 0,i=null,l="1.0"])=>{switch(n=n.toLowerCase(),n){case"post":return c.post(e,r,a,s,i,l);case"put":return c.put(e,r,a,s,l);case"patch":return c.patch(e,r,a,s,i,l);case"delete":return c.delete(e,r,a,s,i,l);default:return c.get(e,r,a,s,i,l)}}};var fr={client:c,swr:$e,utils:d};var Ye=require("@d4us1/remawy"),je=P(require("@rails/activestorage")),ge=class{constructor(r,n,a){this.uploader=r,this.authInfo=n,this.apiVersion=a}directUploadWillCreateBlobWithXHR(r){let n=c.defaultHttpHeader(this.authInfo,null,this.apiVersion);Object.keys(n).forEach(a=>{r.setRequestHeader(a,n[a])}),r.upload.addEventListener("progress",a=>this.uploader.onDirectUploadProgress(a))}},le=class extends Ye.AbstractUploader{constructor(r,n,a){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=n,this.apiVersion=a}startUpload(r){let n=new ge(this,this.authInfo,this.apiVersion);return new je.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,n).create((s,i)=>{if(s)this.onError(s);else{let l=`${this.baseUrl}rails/active_storage/blobs/${i.signed_id}/${i.filename}`,f={signedId:i.signed_id,fileName:i.filename};this.onFinish(l,r,f)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var We={uploader:le};var gr={remawy:We};
//# sourceMappingURL=index.js.map
