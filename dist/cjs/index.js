"use strict";var Ke=Object.create;var ee=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var Ze=Object.getOwnPropertyNames;var Qe=Object.getPrototypeOf,er=Object.prototype.hasOwnProperty;var rr=(e,r)=>{for(var n in r)ee(e,n,{get:r[n],enumerable:!0})},be=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of Ze(r))!er.call(e,s)&&s!==n&&ee(e,s,{get:()=>r[s],enumerable:!(t=Je(r,s))||t.enumerable});return e};var T=(e,r,n)=>(n=e!=null?Ke(Qe(e)):{},be(r||!e||!e.__esModule?ee(n,"default",{value:e,enumerable:!0}):n,e)),nr=e=>be(ee({},"__esModule",{value:!0}),e);var br={};rr(br,{ActiveStorageDropzone:()=>le,DevelopmentHint:()=>He,EzOnRails:()=>Ce,EzOnRailsHttp:()=>pr,EzOnRailsHttpError:()=>Y,EzOnRailsIntegrations:()=>hr,LoginForm:()=>Oe,LostPasswordForm:()=>Ue,ProtectedPage:()=>qe,RegistrationForm:()=>Re,ResendConfirmationForm:()=>Ae,ResetPasswordForm:()=>De,UpdateUserForm:()=>$e,useEzApi:()=>ve,useEzApiHttpClient:()=>se,useEzOnRails:()=>v,useEzScaff:()=>ze});module.exports=nr(br);var H=T(require("react"));var Ee=require("react"),re=(0,Ee.createContext)({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,apiKey:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiKey:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{},setAdditionalHttpHeaders:e=>{}});var Ce=e=>{let[r,n]=(0,H.useState)(e.backendUrl),[t,s]=(0,H.useState)(e.authInfo||null),[i,l]=(0,H.useState)(e.apiVersion),[m,E]=(0,H.useState)(e.apiKey||null),[o,u]=(0,H.useState)(()=>e.onUnauthorizedCallback),[p,U]=(0,H.useState)(e.additionalHttpHeaders),R=(0,H.useCallback)(b=>{u(()=>b)},[]),g=(0,H.useMemo)(()=>{let b={backendUrl:r,authInfo:t||null,apiKey:m||null,apiVersion:i,setBackendUrl:n,setAuthInfo:s,setApiKey:E,setApiVersion:l,setOnUnauthorizedCallback:R,onUnauthorizedCallback:o,additionalHttpHeaders:p,setAdditionalHttpHeaders:U};return b.backendUrl.endsWith("/")&&(b.backendUrl=b.backendUrl.slice(0,-1)),b},[r,t,m,i,R,o,p]);return H.default.createElement(re.Provider,{value:g},e.children)};var P=T(require("react")),B=T(require("yup")),ye=require("formik");var j=require("react");var xe=require("react");var ae=require("convert-keys");var Y=class extends Error{constructor(r,n){super(),this.message=r,this.httpStatusCode=n}};var de=e=>e.startsWith("/")?e.slice(1):e,ue=e=>e.endsWith("/")?e.slice(0,-1):e,tr=(e,r)=>`${ue(e)}/${de(r)}`,ar=(e,r)=>`${ue(e)}/api/${de(r)}`,sr=e=>(e=e.replace(/[A-Z]/g,(r,n)=>n===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),Pe=e=>e&&(0,ae.toSnake)(e),Te=e=>e&&(0,ae.toCamel)(e),ir=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),ne=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>ne(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=ne(e[r])}),e),te=e=>{if(e instanceof Date)try{return e.toISOString()}catch(r){return console.error("ez-on-rails-react: Error converting date to iso string",r),null}return Array.isArray(e)?e.map(r=>te(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=te(e[r])}),e)},or=e=>te(Pe(e)),lr=e=>!e||typeof e!="object"?e:ne(Te(e)),mr=e=>e?e instanceof Y:!1,d={cleanupUrl:ue,cleanupPath:de,toBaseUrl:tr,toApiUrl:ar,toSnakeCase:Pe,toSnakeCasePath:sr,toCamelCase:Te,toGetParameters:ir,toDates:ne,toDateStrings:te,toBackendParams:or,toFrontendParams:lr,isEzOnRailsHttpError:mr};var dr=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},ur=e=>{if(e)return{"api-key":e}},cr=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),k=(e,r,n,t)=>({"Content-Type":"application/json",Accept:"application/json","api-version":n,...ur(r),...dr(e),...t}),L=async(e,r,n,t)=>{let s=await fetch(r,{method:e,headers:t,body:n?JSON.stringify(n):null});if(!s.ok)throw new Y(await s.text(),s.status);let i={},l=null;try{s.headers.forEach((m,E)=>{i[E]=m}),l=await s.json()}catch{}return{headers:i,body:l}},f={signUp:async(e,r,n,t)=>{r=d.toBackendParams(r),await L("POST",d.toBaseUrl(e,"users"),{user:r},k(null,null,n,t))},signIn:async(e,r,n,t)=>{r=d.toBackendParams(r);let s=await L("POST",d.toApiUrl(e,"auth/sign_in"),r,k(null,null,n,t));return cr(s.headers)},signOut:async(e,r,n,t)=>{await L("DELETE",d.toApiUrl(e,"auth/sign_out"),null,k(r,null,n,t))},passwordResetInstructions:async(e,r,n,t)=>{r=d.toBackendParams(r),await L("POST",d.toBaseUrl(e,"users/password"),{user:r},k(null,null,n,t))},passwordReset:async(e,r,n,t)=>{r=d.toBackendParams(r),await L("PUT",d.toBaseUrl(e,"users/password"),{user:r},k(null,null,n,t))},getUser:async(e,r,n,t)=>{let s=await L("GET",d.toApiUrl(e,"users/me"),null,k(r,null,n,t));return d.toFrontendParams(s.body)},updateUser:async(e,r,n,t,s)=>{let i=r.avatar?.signedId,l={...d.toBackendParams(r),avatar:i},m=await L("PATCH",d.toApiUrl(e,"users/me"),{user:l},k(n,null,t,s));return d.toFrontendParams(m.body)},confirmationInstructions:async(e,r,n,t)=>{r=d.toBackendParams(r),await L("POST",d.toBaseUrl(e,"users/confirmation"),{user:r},k(null,null,n,t))},confirmation:async(e,r,n,t)=>{let s=d.toBaseUrl(e,"users/confirmation");r=d.toBackendParams(r),s=`${s}?${d.toGetParameters(r)}`,await L("GET",s,null,k(null,null,n,t))},get:async(e,r,n,t=null,s=null,i="1.0",l=void 0,m)=>{let E=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(E=`${E}?${d.toGetParameters(n)}`);let o=await L("GET",E,null,k(t,s,i,m));return d.toFrontendParams(o.body)},post:async(e,r,n,t=null,s=null,i="1.0",l=void 0,m)=>{let E=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await L("POST",E,n,k(t,s,i,m));return d.toFrontendParams(o.body)},patch:async(e,r,n,t=null,s=null,i="1.0",l=void 0,m)=>{let E=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await L("PATCH",E,n,k(t,s,i,m));return d.toFrontendParams(o.body)},put:async(e,r,n,t=null,s=null,i="1.0",l=void 0,m)=>{let E=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await L("PUT",E,n,k(t,s,i,m));return d.toFrontendParams(o.body)},delete:async(e,r,n,t=null,s=null,i="1.0",l=void 0,m)=>{let E=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(E=`${E}?${d.toGetParameters(n)}`);let o=await L("DELETE",E,null,k(t,s,i,m));return d.toFrontendParams(o.body)},defaultHttpHeader:(e,r,n,t)=>k(e,r,n,t)};var we=require("react");var v=()=>(0,we.useContext)(re);var se=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,onUnauthorizedCallback:i,additionalHttpHeaders:l}=v();return{call:(0,xe.useCallback)(async(E,o,u)=>{let p=e?d.cleanupPath(d.cleanupUrl(e)):null,U=d.cleanupPath(E),R=`${p?p+"/":""}${U}`;try{switch(o){case"POST":return await f.post(r,R,u,n,t,s,void 0,l);case"PUT":return await f.put(r,R,u,n,t,s,void 0,l);case"PATCH":return await f.patch(r,R,u,n,t,s,void 0,l);case"DELETE":return await f.delete(r,R,u,n,t,s,void 0,l);default:return await f.get(r,R,u,n,t,s,void 0,l)}}catch(g){if(!d.isEzOnRailsHttpError(g)||g.httpStatusCode!==401||!i)throw g;return i(),null}},[n,t,s,r,e,i])}};var ve=(e,r="GET",n,t)=>{let[s,i]=(0,j.useState)(null),[l,m]=(0,j.useState)(null),[E,o]=(0,j.useState)(!1),{call:u}=se(),p=(0,j.useCallback)(async U=>{try{o(!0),m(null),i(null);let R=await u(e,r,U||n);return i(R),o(!1),R}catch(R){m(R),o(!1)}},[e,u,n,r]);return(0,j.useEffect)(()=>{(async()=>t?.skipInitialCall||await p())()},[p,t]),{data:s,error:l,inProgress:E,callApi:p}};var S=require("react");var ze=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,additionalHttpHeaders:i}=v(),[l,m]=(0,S.useState)(null),[E,o]=(0,S.useState)(null),[u,p]=(0,S.useState)(!1),[U,R]=(0,S.useState)(null),g=(0,S.useMemo)(()=>d.toSnakeCasePath(e),[e]),b=(0,S.useCallback)(async x=>{R(null),p(!0);try{let F=await x();return p(!1),F}catch(F){return p(!1),R(F),null}},[]),$=(0,S.useCallback)(()=>b(async()=>{let x=await f.get(r,g,null,n,t,s,void 0,i);return o(x),x}),[r,n,t,s,g,i,b]),c=(0,S.useCallback)(x=>b(async()=>{let F=await f.get(r,`${g}/${x}`,null,n,t,s,void 0,i);return m(F),F}),[r,n,t,s,g,i,b]),C=(0,S.useCallback)(x=>b(async()=>{let F=await f.post(r,`${g}/search`,x,n,t,s,void 0,i);return o(F),F}),[r,n,t,s,g,i,b]),A=(0,S.useCallback)(x=>b(async()=>{let F=await f.post(r,g,x,n,t,s,void 0,i);return m(F),F}),[r,n,t,s,g,i,b]),I=(0,S.useCallback)((x,F)=>b(async()=>{let he=await f.patch(r,`${g}/${x}`,F,n,t,s,void 0,i);return m(he),he}),[r,n,t,s,g,i,b]),_=(0,S.useCallback)(x=>b(async()=>{await f.delete(r,`${g}/${x}`,null,n,t,s,void 0,i),m(null)}),[r,n,t,s,g,i,b]);return{record:l,records:E,inProgress:u,error:U,getAll:$,getOne:c,search:C,create:A,update:I,remove:_}};var y=require("react-bootstrap");var a={container:"Form-module__container_7Xp4fa__121",fieldContainer:"Form-module__fieldContainer_7Xp4fa__121",fieldLabel:"Form-module__fieldLabel_7Xp4fa__121"};var Re=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=v(),[s,i]=(0,P.useState)(!1),l=async o=>{i(!0);try{await f.signUp(r,o,n,t),e.onRegisterSuccess(o.email),i(!1)}catch(u){e.onRegisterError(u),i(!1)}},m=B.object().shape({username:B.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:B.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:B.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:B.string().oneOf([B.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match.").required(e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:B.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.").required(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return P.default.createElement(ye.Formik,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:m,onSubmit:o=>{l(o)}},({errors:o,handleChange:u,handleSubmit:p})=>P.default.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},P.default.createElement(y.Form.Group,{id:"username-container",className:e.fieldContainerClassName||a.fieldContainer},P.default.createElement(y.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelUsername||"Username"),P.default.createElement(y.Form.Control,{id:"username",className:e.fieldInputClassName||a.formField,type:"text",onChange:u,isInvalid:!!o.username}),P.default.createElement(y.Form.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},o.username)),P.default.createElement(y.Form.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},P.default.createElement(y.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),P.default.createElement(y.Form.Control,{id:"email",className:e.fieldInputClassName||a.formField,type:"email",onChange:u,isInvalid:!!o.email}),P.default.createElement(y.Form.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},o.email)),P.default.createElement(y.Form.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},P.default.createElement(y.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),P.default.createElement(y.Form.Control,{id:"password",className:e.fieldInputClassName||a.formField,type:"password",onChange:u,isInvalid:!!o.password}),P.default.createElement(y.Form.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},o.password)),P.default.createElement(y.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},P.default.createElement(y.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),P.default.createElement(y.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||a.formField,type:"password",onChange:u,isInvalid:!!o.passwordConfirmation}),P.default.createElement(y.Form.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},o.passwordConfirmation)),P.default.createElement(y.Form.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||a.fieldContainer},P.default.createElement(y.Form.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||a.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||P.default.createElement("span",null,"I have read and accept the"," ",P.default.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",P.default.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:u,isInvalid:!!o.privacyPolicyAccepted,feedbackType:"invalid",feedback:o.privacyPolicyAccepted})),!s&&P.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},P.default.createElement(y.Button,{className:e.submitButtonClassName||a.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};var Fe=require("formik"),M=T(require("react-bootstrap/Form")),Ne=T(require("react-bootstrap/Button")),N=T(require("react")),K=T(require("yup"));var Oe=e=>{let{backendUrl:r,apiVersion:n,setAuthInfo:t,additionalHttpHeaders:s}=v(),[i,l]=(0,N.useState)(!1),m=K.object().shape({email:K.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:K.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),E=async u=>{l(!0);try{let p=await f.signIn(r,u,n,s);if(!p)throw"No authentication object returned";if(t(p),!e.onLoginSuccess)return;await e.onLoginSuccess(u.email,p,u.stayLoggedIn)}catch(p){e.onLoginError(p),l(!1)}};return N.default.createElement(Fe.Formik,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:u=>{E(u)},validationSchema:m},({errors:u,handleChange:p,handleSubmit:U})=>N.default.createElement("form",{onSubmit:U,className:e.containerClassName||a.container},N.default.createElement(M.default.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},N.default.createElement(M.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),N.default.createElement(M.default.Control,{id:"email",type:"email",onChange:p,className:e.fieldInputClassName||a.formField,isInvalid:!!u.email}),N.default.createElement(M.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},u.email)),N.default.createElement(M.default.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},N.default.createElement(M.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),N.default.createElement(M.default.Control,{id:"password",type:"password",onChange:p,className:e.fieldInputClassName||a.formField,isInvalid:!!u.password}),N.default.createElement(M.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},u.password)),!e.hideStayLoggedIn&&N.default.createElement(M.default.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||a.fieldContainer},N.default.createElement(M.default.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||a.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:p})),!i&&N.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},N.default.createElement(Ne.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Login"))))};var V=T(require("react")),ie=T(require("yup"));var ke=require("formik"),J=T(require("react-bootstrap/Form")),Se=T(require("react-bootstrap/Button"));var Ue=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=v(),[s,i]=(0,V.useState)(!1),l=ie.object().shape({email:ie.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),m=o=>{i(!0),f.passwordResetInstructions(r,o,n,t).then(()=>{e.onLostPasswordSuccess(o.email),i(!1)}).catch(u=>{e.onLostPasswordError(u),i(!1)})};return V.default.createElement(ke.Formik,{initialValues:{email:""},onSubmit:o=>{m(o)},validationSchema:l},({errors:o,handleChange:u,handleSubmit:p})=>V.default.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},V.default.createElement(J.default.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},V.default.createElement(J.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),V.default.createElement(J.default.Control,{id:"email",type:"email",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!o.email}),V.default.createElement(J.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},o.email)),!s&&V.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},V.default.createElement(Se.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};var D=T(require("react")),oe=T(require("yup"));var Ie=require("formik"),Z=T(require("react-bootstrap/Form")),Le=T(require("react-bootstrap/Button"));var Ae=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=v(),[s,i]=(0,D.useState)(!1),l=oe.object().shape({email:oe.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),m=o=>{i(!0),f.confirmationInstructions(r,o,n,t).then(()=>{e.onResendConfirmationSuccess(o.email),i(!1)}).catch(u=>{e.onResendConfirmationError(u),i(!1)})};return D.default.createElement(Ie.Formik,{initialValues:{email:""},onSubmit:o=>{m(o)},validationSchema:l},({errors:o,handleChange:u,handleSubmit:p})=>D.default.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},D.default.createElement(Z.default.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},D.default.createElement(Z.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),D.default.createElement(Z.default.Control,{id:"email",type:"email",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!o.email}),D.default.createElement(Z.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},o.email)),!s&&D.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},D.default.createElement(Le.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};var Q=T(require("react"));var ce={container:"DevelopmentHint-module__container_wJV76G__121",text:"DevelopmentHint-module__text_wJV76G__121"};var He=e=>{let[r,n]=(0,Q.useState)(e.visible),t=()=>{n(!0)};return r?Q.default.createElement("div",{onClick:()=>{n(!1),setTimeout(t,e.dismissTimeout||2e4)},className:ce.container},Q.default.createElement("span",{className:ce.text},"development")):null};var w=T(require("react")),_e=T(require("@rails/activestorage")),Be=require("react"),X=T(require("react-dropzone"));var fe={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__121",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__121"};var fr=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,gr=e=>e.match(/\.(jpeg|jpg|gif|png|bmp|tif|tiff)$/)!==null,le=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,additionalHttpHeaders:i}=v(),[l,m]=(0,Be.useState)(0),E=w.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},w.default.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),w.default.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),o=async c=>{await f.delete(r,`active_storage/blobs/${c}`,null,n,t,s,void 0,i)},u=async(c,C)=>{c.stopPropagation(),c.preventDefault(),await o(C);let A=[...e.files];A=A.filter(I=>C!==I.signedId),e.onChange(A)},p=c=>{c.loaded/c.total>=.9999999},U=c=>{if(c.length){if(e.maxFiles){let C=e.maxFiles-(e.files.length+l);if(C<c.length&&e.onMaxFilesError(e.maxFiles),C<=0)return;c=c.slice(0,C)}if(e.maxSize){let C=c.filter(A=>A.size<=e.maxSize);C.length<c.length&&e.onMaxSizeError(e.maxSize),c=C}m(C=>C+c.length),c.forEach(C=>{new _e.DirectUpload(C,d.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:I=>{let _=f.defaultHttpHeader(n,t,s);Object.keys(_).forEach(x=>{I.setRequestHeader(x,_[x])}),I.upload.addEventListener("progress",p)}}).create((I,_)=>{if(m(x=>x-1),!I){let x={signedId:_.signed_id};C.type.includes("image")?x.path=fr(_.signed_id,_.filename):x.filename=_.filename;let F=e.files;F.push(x),e.onChange([...F])}})})}},R=c=>{if(!c.clipboardData)return;let C=c.clipboardData.items;if(C===void 0)return;let A=[];for(let I of C){if(e.accept&&!Object.keys(e.accept).some(x=>I.type.match(x)))continue;let _=I.getAsFile();_&&A.push(_)}U(A)},g=e.files.map(c=>w.default.createElement("div",{key:c.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"card-header p-1"},w.default.createElement("button",{onClick:C=>u(C,c.signedId||""),type:"button",className:"close","aria-label":"Close"},w.default.createElement("span",{"aria-hidden":"true"},"\xD7"))),w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},gr(c.filename||"")?w.default.createElement("img",{src:d.toBaseUrl(r,c.path||""),alt:c.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"}):w.default.createElement("span",null,c.filename)))),b=[];for(let c=0;c<l;c++)b.push(w.default.createElement("div",{key:c,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},w.default.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.default.createElement("div",{className:"p-4 text-center"},w.default.createElement("div",{className:"spinner-border",role:"status"},w.default.createElement("span",{className:"sr-only"}))))));let $=c=>{c.some(C=>C.errors[0].code===X.ErrorCode.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),c.some(C=>C.errors[0].code===X.ErrorCode.FileInvalidType)&&e.onInvalidTypeError(e.accept),c.some(C=>C.errors[0].code===X.ErrorCode.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return w.default.createElement("div",null,e.pasteZone&&w.default.createElement("input",{type:"text",className:`w-100 p-2 ${fe.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:R,readOnly:!0}),w.default.createElement(X.default,{onDropAccepted:U,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:$,accept:e.accept},({getRootProps:c,getInputProps:C})=>w.default.createElement("section",null,w.default.createElement("div",{...c(),className:`${fe.dropzoneContainer} p-4 ${e.className}`},w.default.createElement("input",{...C()}),w.default.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),g.length>0?w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},g):w.default.createElement("div",{className:"m-0"},e.customIcon||E),b.length>0&&w.default.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},b)))))};var Me=require("formik"),q=T(require("react-bootstrap/Form")),Ve=T(require("react-bootstrap/Button")),O=T(require("react")),W=T(require("yup"));var De=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=v(),[s,i]=(0,O.useState)(!1),l=W.object().shape({password:W.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:W.string().oneOf([W.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.").required(e.passwordConfirmationMatchErrorText||"The password and its confirmation must match."),resetPasswordToken:W.string().required("")}).defined(),m=(0,O.useCallback)(async o=>{i(!0);try{await f.passwordReset(r,{...o,resetPasswordToken:e.resetPasswordToken},n,t),await e.onResetPasswordSuccess()}catch(u){e.onResetPasswordError(u),i(!1)}},[e,r,n]);return O.default.createElement(Me.Formik,{initialValues:{password:"",passwordConfirmation:""},onSubmit:o=>{m(o)},validationSchema:l},({errors:o,handleChange:u,handleSubmit:p})=>O.default.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},O.default.createElement(q.default.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},O.default.createElement(q.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),O.default.createElement(q.default.Control,{id:"password",type:"password",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!o.password}),O.default.createElement(q.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},o.password)),O.default.createElement(q.default.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},O.default.createElement(q.default.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),O.default.createElement(q.default.Control,{id:"passwordConfirmation",type:"password",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!o.passwordConfirmation}),O.default.createElement(q.default.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},o.passwordConfirmation)),!s&&O.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},O.default.createElement(Ve.default,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};var ge=T(require("react"));var qe=e=>{let{authInfo:r}=v();return ge.default.createElement("div",null,r?e.children:ge.default.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};var h=T(require("react")),G=T(require("yup")),Ge=require("formik");var z=require("react-bootstrap");var $e=e=>{let{authInfo:r,backendUrl:n,apiVersion:t,additionalHttpHeaders:s}=v(),[i,l]=(0,h.useState)(!1),[m,E]=(0,h.useState)(null),[o,u]=(0,h.useState)(void 0),p=g=>{E(g),u(g.unconfirmedEmail)};(0,h.useEffect)(()=>{(async()=>r&&p(await f.getUser(n,r,t,s)))()},[n,r,t]);let U=async g=>{if(r){l(!0);try{let b=await f.updateUser(n,g,r,t,s);e.onUserUpdateSuccess(b),p(b),l(!1)}catch(b){e.onUserUpdateError(b),l(!1)}}},R=G.object().shape({username:G.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:G.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:G.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:G.string().oneOf([G.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&h.default.createElement("div",{className:"ez-on-rails-form-outer-container"},m?h.default.createElement(Ge.Formik,{initialValues:m,validationSchema:R,enableReinitialize:!0,onSubmit:g=>{U(g)}},({errors:g,values:b,handleChange:$,setFieldValue:c,setFieldError:C,handleSubmit:A})=>h.default.createElement("form",{onSubmit:A,className:e.containerClassName||a.container},!e.hideUsername&&h.default.createElement(z.Form.Group,{id:"username-container",className:e.fieldContainerClassName||a.fieldContainer},h.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelUsername||"Username"),h.default.createElement(z.Form.Control,{id:"username",className:e.fieldInputClassName||a.formField,type:"text",value:b.username,onChange:$,isInvalid:!!g.username}),h.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.username)),!e.hideEmail&&h.default.createElement(z.Form.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},h.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),h.default.createElement(z.Form.Control,{id:"email",className:e.fieldInputClassName||a.formField,type:"email",value:b.email,onChange:$,isInvalid:!!g.email}),o&&h.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",o),h.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.email)),!e.hidePassword&&h.default.createElement(z.Form.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},h.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),h.default.createElement(z.Form.Control,{id:"password",className:e.fieldInputClassName||a.formField,type:"password",value:b.password,onChange:$,isInvalid:!!g.password}),h.default.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),h.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.password)),!e.hidePassword&&h.default.createElement(z.Form.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},h.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),h.default.createElement(z.Form.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||a.formField,type:"password",value:b.passwordConfirmation,onChange:$,isInvalid:!!g.passwordConfirmation}),h.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.passwordConfirmation)),!e.hideAvatar&&h.default.createElement(z.Form.Group,{id:"avatar-container",className:e.fieldContainerClassName||a.fieldContainer},h.default.createElement(z.Form.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelAvatar||"Avatar"),h.default.createElement("div",{className:e.dropzoneContainerClassName||a.formField},h.default.createElement(le,{onChange:I=>c("avatar",I.length>0?I[0]:null),files:b.avatar?[b.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>C("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>C("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>C("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),h.default.createElement(z.Form.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.avatar)),!i&&h.default.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},h.default.createElement(z.Button,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit")))):h.default.createElement("div",null,"Loading..."))};var Ye={fetcher:async([e,r,n="get",t=null,s=void 0,i=null,l="1.0",m=void 0])=>{switch(n=n.toLowerCase(),n){case"post":return f.post(e,r,t,s,i,l,void 0,m);case"put":return f.put(e,r,t,s,i,l,void 0,m);case"patch":return f.patch(e,r,t,s,i,l,void 0,m);case"delete":return f.delete(e,r,t,s,i,l,void 0,m);default:return f.get(e,r,t,s,i,l,void 0,m)}}};var pr={client:f,swr:Ye,utils:d};var je=require("@d4us1/remawy"),We=T(require("@rails/activestorage")),pe=class{constructor(r,n,t){this.uploader=r,this.authInfo=n,this.apiVersion=t}directUploadWillCreateBlobWithXHR(r){let n=f.defaultHttpHeader(this.authInfo,null,this.apiVersion);Object.keys(n).forEach(t=>{r.setRequestHeader(t,n[t])}),r.upload.addEventListener("progress",t=>this.uploader.onDirectUploadProgress(t))}},me=class extends je.AbstractUploader{constructor(r,n,t){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=n,this.apiVersion=t}startUpload(r){let n=new pe(this,this.authInfo,this.apiVersion);return new We.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,n).create((s,i)=>{if(s)this.onError(s);else{let l=`${this.baseUrl}rails/active_storage/blobs/${i.signed_id}/${i.filename}`,m={signedId:i.signed_id,fileName:i.filename};this.onFinish(l,r,m)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var Xe={uploader:me};var hr={remawy:Xe};
//# sourceMappingURL=index.js.map
