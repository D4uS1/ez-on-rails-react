import we,{useCallback as xe,useMemo as ve,useState as $}from"react";import{createContext as Te}from"react";var j=Te({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,apiKey:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiKey:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{}});var ze=e=>{let[r,n]=$(e.backendUrl),[a,s]=$(e.authInfo||null),[i,l]=$(e.apiVersion),[g,o]=$(e.apiKey||null),[m,p]=$(()=>e.onUnauthorizedCallback),z=xe(u=>{p(()=>u)},[]),F=ve(()=>{let u={backendUrl:r,authInfo:a||null,apiKey:g||null,apiVersion:i,setBackendUrl:n,setAuthInfo:s,setApiKey:o,setApiVersion:l,setOnUnauthorizedCallback:z,onUnauthorizedCallback:m};return u.backendUrl.endsWith("/")&&(u.backendUrl=u.backendUrl.slice(0,-1)),u},[r,a,g,i,z,m]);return we.createElement(j.Provider,{value:F},e.children)};import P,{useState as $e}from"react";import*as L from"yup";import{Formik as Ye}from"formik";import{useCallback as Me,useEffect as Ve,useState as se}from"react";import{useCallback as He}from"react";import{toCamel as ye,toSnake as Fe}from"convert-keys";var q=class extends Error{constructor(r,n){super(),this.message=r,this.httpStatusCode=n}};var ne=e=>e.startsWith("/")?e.slice(1):e,ae=e=>e.endsWith("/")?e.slice(0,-1):e,Re=(e,r)=>`${ae(e)}/${ne(r)}`,Ne=(e,r)=>`${ae(e)}/api/${ne(r)}`,Oe=e=>(e=e.replace(/[A-Z]/g,(r,n)=>n===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),fe=e=>e&&Fe(e),ge=e=>e&&ye(e),ke=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),W=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>W(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=W(e[r])}),e),X=e=>{if(e instanceof Date)try{return e.toISOString()}catch(r){return console.error("ez-on-rails-react: Error converting date to iso string",r),null}return Array.isArray(e)?e.map(r=>X(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=X(e[r])}),e)},Se=e=>X(fe(e)),Ue=e=>!e||typeof e!="object"?e:W(ge(e)),Ie=e=>e?e instanceof q:!1,d={cleanupUrl:ae,cleanupPath:ne,toBaseUrl:Re,toApiUrl:Ne,toSnakeCase:fe,toSnakeCasePath:Oe,toCamelCase:ge,toGetParameters:ke,toDates:W,toDateStrings:X,toBackendParams:Se,toFrontendParams:Ue,isEzOnRailsHttpError:Ie};var Le=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},Ae=e=>{if(e)return{"api-key":e}},_e=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),R=(e,r,n)=>({"Content-Type":"application/json",Accept:"application/json","api-version":n,...Ae(r),...Le(e)}),O=async(e,r,n,a)=>{let s=await fetch(r,{method:e,headers:a,body:n?JSON.stringify(n):null});if(!s.ok)throw new q(await s.text(),s.status);let i={},l=null;try{s.headers.forEach((g,o)=>{i[o]=g}),l=await s.json()}catch{}return{headers:i,body:l}},f={signUp:async(e,r,n)=>{r=d.toBackendParams(r),await O("POST",d.toBaseUrl(e,"users"),{user:r},R(null,null,n))},signIn:async(e,r,n)=>{r=d.toBackendParams(r);let a=await O("POST",d.toApiUrl(e,"auth/sign_in"),r,R(null,null,n));return _e(a.headers)},signOut:async(e,r,n)=>{await O("DELETE",d.toApiUrl(e,"auth/sign_out"),null,R(r,null,n))},passwordResetInstructions:async(e,r,n)=>{r=d.toBackendParams(r),await O("POST",d.toBaseUrl(e,"users/password"),{user:r},R(null,null,n))},passwordReset:async(e,r,n)=>{r=d.toBackendParams(r),await O("PUT",d.toBaseUrl(e,"users/password"),{user:r},R(null,null,n))},getUser:async(e,r,n)=>{let a=await O("GET",d.toApiUrl(e,"users/me"),null,R(r,null,n));return d.toFrontendParams(a.body)},updateUser:async(e,r,n,a)=>{let s=r.avatar?.signedId,i={...d.toBackendParams(r),avatar:s},l=await O("PATCH",d.toApiUrl(e,"users/me"),{user:i},R(n,null,a));return d.toFrontendParams(l.body)},confirmationInstructions:async(e,r,n)=>{r=d.toBackendParams(r),await O("POST",d.toBaseUrl(e,"users/confirmation"),{user:r},R(null,null,n))},confirmation:async(e,r,n)=>{let a=d.toBaseUrl(e,"users/confirmation");r=d.toBackendParams(r),a=`${a}?${d.toGetParameters(r)}`,await O("GET",a,null,R(null,null,n))},get:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let g=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(g=`${g}?${d.toGetParameters(n)}`);let o=await O("GET",g,null,R(a,s,i));return d.toFrontendParams(o.body)},post:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let g=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await O("POST",g,n,R(a,s,i));return d.toFrontendParams(o.body)},patch:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let g=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await O("PATCH",g,n,R(a,s,i));return d.toFrontendParams(o.body)},put:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let g=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let o=await O("PUT",g,n,R(a,s,i));return d.toFrontendParams(o.body)},delete:async(e,r,n,a=null,s=null,i="1.0",l=void 0)=>{let g=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(g=`${g}?${d.toGetParameters(n)}`);let o=await O("DELETE",g,null,R(a,s,i));return d.toFrontendParams(o.body)},defaultHttpHeader:(e,r,n)=>R(e,r,n)};import{useContext as Be}from"react";var w=()=>Be(j);var te=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s,onUnauthorizedCallback:i}=w();return{call:He(async(g,o,m)=>{let p=e?d.cleanupPath(d.cleanupUrl(e)):null,z=d.cleanupPath(g),F=`${p?p+"/":""}${z}`;try{switch(o){case"POST":return await f.post(r,F,m,n,a,s);case"PUT":return await f.put(r,F,m,n,a,s);case"PATCH":return await f.patch(r,F,m,n,a,s);case"DELETE":return await f.delete(r,F,m,n,a,s);default:return await f.get(r,F,m,n,a,s)}}catch(u){if(!d.isEzOnRailsHttpError(u)||u.httpStatusCode!==401||!i)throw u;return i(),null}},[n,a,s,r,e,i])}};var De=(e,r="GET",n,a)=>{let[s,i]=se(null),[l,g]=se(null),[o,m]=se(!1),{call:p}=te(),z=Me(async F=>{try{m(!0),g(null),i(null);let u=await p(e,r,F||n);return i(u),m(!1),u}catch(u){g(u),m(!1)}},[e,p,n,r]);return Ve(()=>{(async()=>a?.skipInitialCall||await z())()},[z,a]),{data:s,error:l,inProgress:o,callApi:z}};import{useCallback as G,useMemo as qe,useState as K}from"react";var Ge=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s}=w(),[i,l]=K(null),[g,o]=K(null),[m,p]=K(!1),[z,F]=K(null),u=qe(()=>d.toSnakeCasePath(e),[e]),E=G(async C=>{F(null),p(!0);try{let y=await C();return p(!1),y}catch(y){return p(!1),F(y),null}},[]),B=G(()=>E(async()=>{let C=await f.get(r,u,null,n,a,s);return o(C),C}),[r,n,a,s,u,E]),c=G(C=>E(async()=>{let y=await f.get(r,`${u}/${C}`,null,n,a,s);return l(y),y}),[r,n,a,s,u,E]),h=G(C=>E(async()=>{let y=await f.post(r,`${u}/search`,C,n,a,s);return o(y),y}),[r,n,a,s,u,E]),S=G(C=>E(async()=>{let y=await f.post(r,u,C,n,a,s);return l(y),y}),[r,n,a,s,u,E]),N=G((C,y)=>E(async()=>{let ce=await f.patch(r,`${u}/${C}`,y,n,a,s);return l(ce),ce}),[r,n,a,s,u,E]),U=G(C=>E(async()=>{await f.delete(r,`${u}/${C}`,null,n,a,s),l(null)}),[r,n,a,s,u,E]);return{record:i,records:g,inProgress:m,error:z,getAll:B,getOne:c,search:h,create:S,update:N,remove:U}};import{Button as je,Form as v}from"react-bootstrap";var t={container:"Form-module__container_7Xp4fa__120",fieldContainer:"Form-module__fieldContainer_7Xp4fa__120",fieldLabel:"Form-module__fieldLabel_7Xp4fa__120"};var We=e=>{let{backendUrl:r,apiVersion:n}=w(),[a,s]=$e(!1),i=async o=>{s(!0);try{await f.signUp(r,o,n),e.onRegisterSuccess(o.email),s(!1)}catch(m){e.onRegisterError(m),s(!1)}},l=L.object().shape({username:L.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:L.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:L.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:L.string().oneOf([L.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match.").required(e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:L.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.").required(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return P.createElement(Ye,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:l,onSubmit:o=>{i(o)}},({errors:o,handleChange:m,handleSubmit:p})=>P.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},P.createElement(v.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),P.createElement(v.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",onChange:m,isInvalid:!!o.username}),P.createElement(v.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.username)),P.createElement(v.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),P.createElement(v.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",onChange:m,isInvalid:!!o.email}),P.createElement(v.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.email)),P.createElement(v.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),P.createElement(v.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",onChange:m,isInvalid:!!o.password}),P.createElement(v.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.password)),P.createElement(v.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),P.createElement(v.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",onChange:m,isInvalid:!!o.passwordConfirmation}),P.createElement(v.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.passwordConfirmation)),P.createElement(v.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},P.createElement(v.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||P.createElement("span",null,"I have read and accept the"," ",P.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",P.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:m,isInvalid:!!o.privacyPolicyAccepted,feedbackType:"invalid",feedback:o.privacyPolicyAccepted})),!a&&P.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},P.createElement(je,{className:e.submitButtonClassName||t.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};import{Formik as Xe}from"formik";import A from"react-bootstrap/Form";import Ke from"react-bootstrap/Button";import k,{useState as Je}from"react";import*as Y from"yup";var Ze=e=>{let{backendUrl:r,apiVersion:n,setAuthInfo:a}=w(),[s,i]=Je(!1),l=Y.object().shape({email:Y.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:Y.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),g=async m=>{i(!0);try{let p=await f.signIn(r,m,n);if(!p)throw"No authentication object returned";if(a(p),!e.onLoginSuccess)return;await e.onLoginSuccess(m.email,p,m.stayLoggedIn)}catch(p){e.onLoginError(p),i(!1)}};return k.createElement(Xe,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:m=>{g(m)},validationSchema:l},({errors:m,handleChange:p,handleSubmit:z})=>k.createElement("form",{onSubmit:z,className:e.containerClassName||t.container},k.createElement(A.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},k.createElement(A.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),k.createElement(A.Control,{id:"email",type:"email",onChange:p,className:e.fieldInputClassName||t.formField,isInvalid:!!m.email}),k.createElement(A.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},m.email)),k.createElement(A.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},k.createElement(A.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),k.createElement(A.Control,{id:"password",type:"password",onChange:p,className:e.fieldInputClassName||t.formField,isInvalid:!!m.password}),k.createElement(A.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},m.password)),!e.hideStayLoggedIn&&k.createElement(A.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},k.createElement(A.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:p})),!s&&k.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},k.createElement(Ke,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Login"))))};import H,{useState as Qe}from"react";import*as Z from"yup";import{Formik as er}from"formik";import J from"react-bootstrap/Form";import rr from"react-bootstrap/Button";var nr=e=>{let{backendUrl:r,apiVersion:n}=w(),[a,s]=Qe(!1),i=Z.object().shape({email:Z.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),l=o=>{s(!0),f.passwordResetInstructions(r,o,n).then(()=>{e.onLostPasswordSuccess(o.email),s(!1)}).catch(m=>{e.onLostPasswordError(m),s(!1)})};return H.createElement(er,{initialValues:{email:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:p})=>H.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},H.createElement(J.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},H.createElement(J.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),H.createElement(J.Control,{id:"email",type:"email",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),H.createElement(J.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!a&&H.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},H.createElement(rr,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import M,{useState as ar}from"react";import*as ee from"yup";import{Formik as tr}from"formik";import Q from"react-bootstrap/Form";import sr from"react-bootstrap/Button";var or=e=>{let{backendUrl:r,apiVersion:n}=w(),[a,s]=ar(!1),i=ee.object().shape({email:ee.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),l=o=>{s(!0),f.confirmationInstructions(r,o,n).then(()=>{e.onResendConfirmationSuccess(o.email),s(!1)}).catch(m=>{e.onResendConfirmationError(m),s(!1)})};return M.createElement(tr,{initialValues:{email:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:p})=>M.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},M.createElement(Q.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},M.createElement(Q.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),M.createElement(Q.Control,{id:"email",type:"email",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),M.createElement(Q.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!a&&M.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},M.createElement(sr,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import pe,{useState as ir}from"react";var oe={container:"DevelopmentHint-module__container_wJV76G__120",text:"DevelopmentHint-module__text_wJV76G__120"};var lr=e=>{let[r,n]=ir(e.visible),a=()=>{n(!0)};return r?pe.createElement("div",{onClick:()=>{n(!1),setTimeout(a,e.dismissTimeout||2e4)},className:oe.container},pe.createElement("span",{className:oe.text},"development")):null};import T from"react";import*as he from"@rails/activestorage";import{useState as mr}from"react";import dr,{ErrorCode as le}from"react-dropzone";var ie={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__120",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__120"};var ur=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,me=e=>{let{backendUrl:r,authInfo:n,apiKey:a,apiVersion:s}=w(),[i,l]=mr(0),g=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},T.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),T.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),o=async c=>{await f.delete(r,`active_storage/blobs/${c}`,null,n,a,s)},m=async(c,h)=>{await o(h);let S=[...e.files];S=S.filter(N=>h!==N.signedId),e.onChange(S),c.stopPropagation(),c.preventDefault()},p=c=>{c.loaded/c.total>=.9999999},z=c=>{if(c.length){if(e.maxFiles){let h=e.maxFiles-(e.files.length+i);if(h<c.length&&e.onMaxFilesError(e.maxFiles),h<=0)return;c=c.slice(0,h)}if(e.maxSize){let h=c.filter(S=>S.size<=e.maxSize);h.length<c.length&&e.onMaxSizeError(e.maxSize),c=h}l(h=>h+c.length),c.forEach(h=>{new he.DirectUpload(h,d.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:N=>{let U=f.defaultHttpHeader(n,a,s);Object.keys(U).forEach(C=>{N.setRequestHeader(C,U[C])}),N.upload.addEventListener("progress",p)}}).create((N,U)=>{if(l(C=>C-1),!N){let C={signedId:U.signed_id};h.type.includes("image")?C.path=ur(U.signed_id,U.filename):C.filename=U.filename;let y=e.files;y.push(C),e.onChange([...y])}})})}},F=c=>{if(!c.clipboardData)return;let h=c.clipboardData.items;if(h===void 0)return;let S=[];for(let N of h){if(e.accept&&!Object.keys(e.accept).some(C=>N.type.match(C)))continue;let U=N.getAsFile();U&&S.push(U)}z(S)},u=e.files.map(c=>T.createElement("div",{key:c.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},T.createElement("div",{className:"card-header p-1"},T.createElement("button",{onClick:h=>m(h,c.signedId||""),type:"button",className:"close","aria-label":"Close"},T.createElement("span",{"aria-hidden":"true"},"\xD7"))),T.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},T.createElement("img",{src:d.toBaseUrl(r,c.path||""),alt:c.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"})))),E=[];for(let c=0;c<i;c++)E.push(T.createElement("div",{key:c,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},T.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},T.createElement("div",{className:"p-4 text-center"},T.createElement("div",{className:"spinner-border",role:"status"},T.createElement("span",{className:"sr-only"},"Loading..."))))));let B=c=>{c.some(h=>h.errors[0].code===le.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),c.some(h=>h.errors[0].code===le.FileInvalidType)&&e.onInvalidTypeError(e.accept),c.some(h=>h.errors[0].code===le.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return T.createElement("div",null,e.pasteZone&&T.createElement("input",{type:"text",className:`w-100 p-2 ${ie.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:F,readOnly:!0}),T.createElement(dr,{onDropAccepted:z,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:B,accept:e.accept},({getRootProps:c,getInputProps:h})=>T.createElement("section",null,T.createElement("div",{...c(),className:`${ie.dropzoneContainer} p-4 ${e.className}`},T.createElement("input",{...h()}),T.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),u.length>0?T.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},u):T.createElement("div",{className:"m-0"},e.customIcon||g),E.length>0&&T.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},E)))))};import{Formik as cr}from"formik";import V from"react-bootstrap/Form";import fr from"react-bootstrap/Button";import I,{useCallback as gr,useState as pr}from"react";import*as D from"yup";var hr=e=>{let{backendUrl:r,apiVersion:n}=w(),[a,s]=pr(!1),i=D.object().shape({password:D.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:D.string().oneOf([D.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.").required(e.passwordConfirmationMatchErrorText||"The password and its confirmation must match."),resetPasswordToken:D.string().required("")}).defined(),l=gr(async o=>{s(!0);try{await f.passwordReset(r,{...o,resetPasswordToken:e.resetPasswordToken},n),await e.onResetPasswordSuccess()}catch(m){e.onResetPasswordError(m),s(!1)}},[e,r,n]);return I.createElement(cr,{initialValues:{password:"",passwordConfirmation:""},onSubmit:o=>{l(o)},validationSchema:i},({errors:o,handleChange:m,handleSubmit:p})=>I.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},I.createElement(V.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},I.createElement(V.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),I.createElement(V.Control,{id:"password",type:"password",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.password}),I.createElement(V.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.password)),I.createElement(V.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},I.createElement(V.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),I.createElement(V.Control,{id:"passwordConfirmation",type:"password",onChange:m,className:e.fieldInputClassName||t.formField,isInvalid:!!o.passwordConfirmation}),I.createElement(V.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.passwordConfirmation)),!a&&I.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},I.createElement(fr,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import be from"react";var br=e=>{let{authInfo:r}=w();return be.createElement("div",null,r?e.children:be.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};import b,{useEffect as Er,useState as de}from"react";import*as _ from"yup";import{Formik as Cr}from"formik";import{Button as Pr,Form as x}from"react-bootstrap";var Tr=e=>{let{authInfo:r,backendUrl:n,apiVersion:a}=w(),[s,i]=de(!1),[l,g]=de(null),[o,m]=de(void 0),p=u=>{g(u),m(u.unconfirmedEmail)};Er(()=>{(async()=>r&&p(await f.getUser(n,r,a)))()},[n,r,a]);let z=async u=>{if(r){i(!0);try{let E=await f.updateUser(n,u,r,a);e.onUserUpdateSuccess(E),p(E),i(!1)}catch(E){e.onUserUpdateError(E),i(!1)}}},F=_.object().shape({username:_.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:_.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:_.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:_.string().oneOf([_.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&b.createElement("div",{className:"ez-on-rails-form-outer-container"},l?b.createElement(Cr,{initialValues:l,validationSchema:F,enableReinitialize:!0,onSubmit:u=>{z(u)}},({errors:u,values:E,handleChange:B,setFieldValue:c,setFieldError:h,handleSubmit:S})=>b.createElement("form",{onSubmit:S,className:e.containerClassName||t.container},!e.hideUsername&&b.createElement(x.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(x.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),b.createElement(x.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",value:E.username,onChange:B,isInvalid:!!u.username}),b.createElement(x.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.username)),!e.hideEmail&&b.createElement(x.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(x.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),b.createElement(x.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",value:E.email,onChange:B,isInvalid:!!u.email}),o&&b.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",o),b.createElement(x.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.email)),!e.hidePassword&&b.createElement(x.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(x.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),b.createElement(x.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",value:E.password,onChange:B,isInvalid:!!u.password}),b.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),b.createElement(x.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.password)),!e.hidePassword&&b.createElement(x.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(x.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),b.createElement(x.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",value:E.passwordConfirmation,onChange:B,isInvalid:!!u.passwordConfirmation}),b.createElement(x.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.passwordConfirmation)),!e.hideAvatar&&b.createElement(x.Group,{id:"avatar-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(x.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelAvatar||"Avatar"),b.createElement("div",{className:e.dropzoneContainerClassName||t.formField},b.createElement(me,{onChange:N=>c("avatar",N.length>0?N[0]:null),files:E.avatar?[E.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>h("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>h("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>h("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),b.createElement(x.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},u.avatar)),!s&&b.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},b.createElement(Pr,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit")))):b.createElement("div",null,"Loading..."))};var Ee={fetcher:async([e,r,n="get",a=null,s=void 0,i=null,l="1.0"])=>{switch(n=n.toLowerCase(),n){case"post":return f.post(e,r,a,s,i,l);case"put":return f.put(e,r,a,s,l);case"patch":return f.patch(e,r,a,s,i,l);case"delete":return f.delete(e,r,a,s,i,l);default:return f.get(e,r,a,s,i,l)}}};var ot={client:f,swr:Ee,utils:d};import{AbstractUploader as wr}from"@d4us1/remawy";import*as Ce from"@rails/activestorage";var ue=class{constructor(r,n,a){this.uploader=r,this.authInfo=n,this.apiVersion=a}directUploadWillCreateBlobWithXHR(r){let n=f.defaultHttpHeader(this.authInfo,null,this.apiVersion);Object.keys(n).forEach(a=>{r.setRequestHeader(a,n[a])}),r.upload.addEventListener("progress",a=>this.uploader.onDirectUploadProgress(a))}},re=class extends wr{constructor(r,n,a){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=n,this.apiVersion=a}startUpload(r){let n=new ue(this,this.authInfo,this.apiVersion);return new Ce.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,n).create((s,i)=>{if(s)this.onError(s);else{let l=`${this.baseUrl}rails/active_storage/blobs/${i.signed_id}/${i.filename}`,g={signedId:i.signed_id,fileName:i.filename};this.onFinish(l,r,g)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var Pe={uploader:re};var ht={remawy:Pe};export{me as ActiveStorageDropzone,lr as DevelopmentHint,ze as EzOnRails,ot as EzOnRailsHttp,q as EzOnRailsHttpError,ht as EzOnRailsIntegrations,Ze as LoginForm,nr as LostPasswordForm,br as ProtectedPage,We as RegistrationForm,or as ResendConfirmationForm,hr as ResetPasswordForm,Tr as UpdateUserForm,De as useEzApi,te as useEzApiHttpClient,w as useEzOnRails,Ge as useEzScaff};
//# sourceMappingURL=index.js.map
