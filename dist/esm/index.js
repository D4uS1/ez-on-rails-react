import Te,{useCallback as we,useMemo as xe,useState as Y}from"react";import{createContext as Pe}from"react";var $=Pe({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{}});var ve=e=>{let[r,a]=Y(e.backendUrl),[n,i]=Y(e.authInfo||null),[s,d]=Y(e.apiVersion),[g,o]=Y(()=>e.onUnauthorizedCallback),l=we(E=>{o(()=>E)},[]),p=xe(()=>{let E={backendUrl:r,authInfo:n||null,apiVersion:s,setBackendUrl:a,setAuthInfo:i,setApiVersion:d,setOnUnauthorizedCallback:l,onUnauthorizedCallback:g};return E.backendUrl.endsWith("/")&&(E.backendUrl=E.backendUrl.slice(0,-1)),E},[r,n,s,l,g]);return Te.createElement($.Provider,{value:p},e.children)};import P,{useState as qe}from"react";import*as L from"yup";import{Formik as Ge}from"formik";import{useCallback as Be,useEffect as He,useState as te}from"react";import{useCallback as _e}from"react";import{toCamel as ze,toSnake as Fe}from"convert-keys";var V=class extends Error{constructor(r,a){super(),this.message=r,this.httpStatusCode=a}};var re=e=>e.startsWith("/")?e.slice(1):e,ae=e=>e.endsWith("/")?e.slice(0,-1):e,ye=(e,r)=>`${ae(e)}/${re(r)}`,Re=(e,r)=>`${ae(e)}/api/${re(r)}`,Ne=e=>(e=e.replace(/[A-Z]/g,(r,a)=>a===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),ce=e=>e&&Fe(e),fe=e=>e&&ze(e),Oe=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),j=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>j(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=j(e[r])}),e),W=e=>e instanceof Date?e.toISOString():Array.isArray(e)?e.map(r=>W(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=W(e[r])}),e),ke=e=>W(ce(e)),Se=e=>!e||typeof e!="object"?e:j(fe(e)),Ue=e=>e?e instanceof V:!1,m={cleanupUrl:ae,cleanupPath:re,toBaseUrl:ye,toApiUrl:Re,toSnakeCase:ce,toSnakeCasePath:Ne,toCamelCase:fe,toGetParameters:Oe,toDates:j,toDateStrings:W,toBackendParams:ke,toFrontendParams:Se,isEzOnRailsHttpError:Ue};var Ie=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},Le=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),O=(e,r)=>({"Content-Type":"application/json",Accept:"application/json","api-version":r,...Ie(e)}),k=async(e,r,a,n)=>{let i=await fetch(r,{method:e,headers:n,body:a?JSON.stringify(a):null});if(!i.ok)throw new V(await i.text(),i.status);let s={},d=null;try{i.headers.forEach((g,o)=>{s[o]=g}),d=await i.json()}catch{}return{headers:s,body:d}},c={signUp:async(e,r,a)=>{r=m.toBackendParams(r),await k("POST",m.toBaseUrl(e,"users"),{user:r},O(null,a))},signIn:async(e,r,a)=>{r=m.toBackendParams(r);let n=await k("POST",m.toApiUrl(e,"auth/sign_in"),r,O(null,a));return Le(n.headers)},signOut:async(e,r,a)=>{await k("DELETE",m.toApiUrl(e,"auth/sign_out"),null,O(r,a))},passwordResetInstructions:async(e,r,a)=>{r=m.toBackendParams(r),await k("POST",m.toBaseUrl(e,"users/password"),{user:r},O(null,a))},passwordReset:async(e,r,a)=>{r=m.toBackendParams(r),await k("PUT",m.toBaseUrl(e,"users/password"),{user:r},O(null,a))},getUser:async(e,r,a)=>{let n=await k("GET",m.toApiUrl(e,"users/me"),null,O(r,a));return m.toFrontendParams(n.body)},updateUser:async(e,r,a,n)=>{let i=r.avatar?.signedId,s={...m.toBackendParams(r),avatar:i},d=await k("PATCH",m.toApiUrl(e,"users/me"),{user:s},O(a,n));return m.toFrontendParams(d.body)},confirmationInstructions:async(e,r,a)=>{r=m.toBackendParams(r),await k("POST",m.toBaseUrl(e,"users/confirmation"),{user:r},O(null,a))},confirmation:async(e,r,a)=>{let n=m.toBaseUrl(e,"users/confirmation");r=m.toBackendParams(r),n=`${n}?${m.toGetParameters(r)}`,await k("GET",n,null,O(null,a))},get:async(e,r,a,n=null,i="1.0",s=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),s&&(a=s(a)),a&&(d=`${d}?${m.toGetParameters(a)}`);let g=await k("GET",d,null,O(n,i));return m.toFrontendParams(g.body)},post:async(e,r,a,n=null,i="1.0",s=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),s&&(a=s(a));let g=await k("POST",d,a,O(n,i));return m.toFrontendParams(g.body)},patch:async(e,r,a,n=null,i="1.0",s=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),s&&(a=s(a));let g=await k("PATCH",d,a,O(n,i));return m.toFrontendParams(g.body)},put:async(e,r,a,n=null,i="1.0",s=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),s&&(a=s(a));let g=await k("PUT",d,a,O(n,i));return m.toFrontendParams(g.body)},delete:async(e,r,a,n=null,i="1.0",s=void 0)=>{let d=m.toApiUrl(e,r);a&&(a=m.toBackendParams(a)),s&&(a=s(a)),a&&(d=`${d}?${m.toGetParameters(a)}`);let g=await k("DELETE",d,null,O(n,i));return m.toFrontendParams(g.body)},defaultHttpHeader:(e,r)=>O(e,r)};import{useContext as Ae}from"react";var x=()=>Ae($);var ne=e=>{let{backendUrl:r,authInfo:a,apiVersion:n,onUnauthorizedCallback:i}=x();return{call:_e(async(d,g,o)=>{let l=e?m.cleanupPath(m.cleanupUrl(e)):null,p=m.cleanupPath(d),E=`${l?l+"/":""}${p}`;try{switch(g){case"POST":return await c.post(r,E,o,a,n);case"PUT":return await c.put(r,E,o,a,n);case"PATCH":return await c.patch(r,E,o,a,n);case"DELETE":return await c.delete(r,E,o,a,n);default:return await c.get(r,E,o,a,n)}}catch(w){if(!m.isEzOnRailsHttpError(w)||w.httpStatusCode!==401||!i)throw w;return i(),null}},[a,n,r,e,i])}};var Me=(e,r="GET",a,n)=>{let[i,s]=te(null),[d,g]=te(null),[o,l]=te(!1),{call:p}=ne(),E=Be(async w=>{try{l(!0),g(null),s(null);let f=await p(e,r,w||a);return s(f),l(!1),f}catch(f){g(f),l(!1)}},[e,p,a,r]);return He(()=>{(async()=>n?.skipInitialCall||await E())()},[E,n]),{data:i,error:d,inProgress:o,callApi:E}};import{useCallback as D,useMemo as Ve,useState as X}from"react";var De=e=>{let{backendUrl:r,authInfo:a,apiVersion:n}=x(),[i,s]=X(null),[d,g]=X(null),[o,l]=X(!1),[p,E]=X(null),w=Ve(()=>m.toSnakeCasePath(e),[e]),f=D(async C=>{E(null),l(!0);try{let F=await C();return l(!1),F}catch(F){return l(!1),E(F),null}},[]),y=D(()=>f(async()=>{let C=await c.get(r,w,null,a,n);return g(C),C}),[r,a,n,w,f]),u=D(C=>f(async()=>{let F=await c.get(r,`${w}/${C}`,null,a,n);return s(F),F}),[r,a,n,w,f]),h=D(C=>f(async()=>{let F=await c.get(r,w,C,a,n);return g(F),F}),[r,a,n,w,f]),R=D(C=>f(async()=>{let F=await c.post(r,w,C,a,n);return s(F),F}),[r,a,n,w,f]),U=D((C,F)=>f(async()=>{let ue=await c.patch(r,`${w}/${C}`,F,a,n);return s(ue),ue}),[r,a,n,w,f]),N=D(C=>f(async()=>{await c.delete(r,`${w}/${C}`,null,a,n),s(null)}),[r,a,n,w,f]);return{record:i,records:d,inProgress:o,error:p,getAll:y,getOne:u,search:h,create:R,update:U,remove:N}};import{Button as $e,Form as z}from"react-bootstrap";var t={container:"Form-module__container_7Xp4fa__090",fieldContainer:"Form-module__fieldContainer_7Xp4fa__090",fieldLabel:"Form-module__fieldLabel_7Xp4fa__090"};var Ye=e=>{let{backendUrl:r,apiVersion:a}=x(),[n,i]=qe(!1),s=async o=>{i(!0);try{await c.signUp(r,o,a),e.onRegisterSuccess(o.email),i(!1)}catch(l){e.onRegisterError(l),i(!1)}},d=L.object().shape({username:L.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:L.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:L.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:L.string().oneOf([L.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:L.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return P.createElement(Ge,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:d,onSubmit:o=>{s(o)}},({errors:o,handleChange:l,handleSubmit:p})=>P.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},P.createElement(z.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(z.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),P.createElement(z.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",onChange:l,isInvalid:!!o.username}),P.createElement(z.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.username)),P.createElement(z.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(z.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),P.createElement(z.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",onChange:l,isInvalid:!!o.email}),P.createElement(z.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.email)),P.createElement(z.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(z.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),P.createElement(z.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",onChange:l,isInvalid:!!o.password}),P.createElement(z.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.password)),P.createElement(z.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},P.createElement(z.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),P.createElement(z.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",onChange:l,isInvalid:!!o.passwordConfirmation}),P.createElement(z.Control.Feedback,{className:e.fieldErrorClassName||t.fieldError,type:"invalid"},o.passwordConfirmation)),P.createElement(z.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},P.createElement(z.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||P.createElement("span",null,"I have read and accept the"," ",P.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",P.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:l,isInvalid:!!o.privacyPolicyAccepted,feedbackType:"invalid",feedback:o.privacyPolicyAccepted})),!n&&P.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},P.createElement($e,{className:e.submitButtonClassName||t.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};import{Formik as je}from"formik";import A from"react-bootstrap/Form";import We from"react-bootstrap/Button";import S,{useState as Xe}from"react";import*as G from"yup";var Je=e=>{let{backendUrl:r,apiVersion:a,setAuthInfo:n}=x(),[i,s]=Xe(!1),d=G.object().shape({email:G.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:G.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),g=async l=>{s(!0);try{let p=await c.signIn(r,l,a);if(!p)throw"No authentication object returned";if(n(p),!e.onLoginSuccess)return;await e.onLoginSuccess(l.email,p,l.stayLoggedIn)}catch(p){e.onLoginError(p),s(!1)}};return S.createElement(je,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:l=>{g(l)},validationSchema:d},({errors:l,handleChange:p,handleSubmit:E})=>S.createElement("form",{onSubmit:E,className:e.containerClassName||t.container},S.createElement(A.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},S.createElement(A.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),S.createElement(A.Control,{id:"email",type:"email",onChange:p,className:e.fieldInputClassName||t.formField,isInvalid:!!l.email}),S.createElement(A.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},l.email)),S.createElement(A.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},S.createElement(A.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),S.createElement(A.Control,{id:"password",type:"password",onChange:p,className:e.fieldInputClassName||t.formField,isInvalid:!!l.password}),S.createElement(A.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},l.password)),!e.hideStayLoggedIn&&S.createElement(A.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||t.fieldContainer},S.createElement(A.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||t.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:p})),!i&&S.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},S.createElement(We,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Login"))))};import B,{useState as Ze}from"react";import*as Z from"yup";import{Formik as Ke}from"formik";import J from"react-bootstrap/Form";import Qe from"react-bootstrap/Button";var er=e=>{let{backendUrl:r,apiVersion:a}=x(),[n,i]=Ze(!1),s=Z.object().shape({email:Z.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),d=o=>{i(!0),c.passwordResetInstructions(r,o,a).then(()=>{e.onLostPasswordSuccess(o.email),i(!1)}).catch(l=>{e.onLostPasswordError(l),i(!1)})};return B.createElement(Ke,{initialValues:{email:""},onSubmit:o=>{d(o)},validationSchema:s},({errors:o,handleChange:l,handleSubmit:p})=>B.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},B.createElement(J.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},B.createElement(J.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),B.createElement(J.Control,{id:"email",type:"email",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),B.createElement(J.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!n&&B.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},B.createElement(Qe,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import H,{useState as rr}from"react";import*as Q from"yup";import{Formik as ar}from"formik";import K from"react-bootstrap/Form";import nr from"react-bootstrap/Button";var tr=e=>{let{backendUrl:r,apiVersion:a}=x(),[n,i]=rr(!1),s=Q.object().shape({email:Q.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),d=o=>{i(!0),c.confirmationInstructions(r,o,a).then(()=>{e.onResendConfirmationSuccess(o.email),i(!1)}).catch(l=>{e.onResendConfirmationError(l),i(!1)})};return H.createElement(ar,{initialValues:{email:""},onSubmit:o=>{d(o)},validationSchema:s},({errors:o,handleChange:l,handleSubmit:p})=>H.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},H.createElement(K.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},H.createElement(K.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),H.createElement(K.Control,{id:"email",type:"email",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!o.email}),H.createElement(K.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.email)),!n&&H.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},H.createElement(nr,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import ge,{useState as sr}from"react";var se={container:"DevelopmentHint-module__container_wJV76G__090",text:"DevelopmentHint-module__text_wJV76G__090"};var or=e=>{let[r,a]=sr(e.visible),n=()=>{a(!0)};return r?ge.createElement("div",{onClick:()=>{a(!1),setTimeout(n,e.dismissTimeout||2e4)},className:se.container},ge.createElement("span",{className:se.text},"development")):null};import T from"react";import*as pe from"@rails/activestorage";import{useState as ir}from"react";import lr,{ErrorCode as ie}from"react-dropzone";var oe={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__090",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__090"};var mr=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,le=e=>{let{backendUrl:r,authInfo:a,apiVersion:n}=x(),[i,s]=ir(0),d=T.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},T.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),T.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),g=async u=>{await c.delete(r,`active_storage/blobs/${u}`,null,a,n)},o=async(u,h)=>{await g(h);let R=[...e.files];R=R.filter(U=>h!==U.signedId),e.onChange(R),u.stopPropagation()},l=u=>{u.loaded/u.total>=.9999999},p=u=>{if(u.length){if(e.maxFiles){let h=e.maxFiles-(e.files.length+i);if(h<u.length&&e.onMaxFilesError(e.maxFiles),h<=0)return;u=u.slice(0,h)}if(e.maxSize){let h=u.filter(R=>R.size<=e.maxSize);h.length<u.length&&e.onMaxSizeError(e.maxSize),u=h}s(h=>h+u.length),u.forEach(h=>{new pe.DirectUpload(h,m.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:U=>{let N=c.defaultHttpHeader(a,n);Object.keys(N).forEach(C=>{U.setRequestHeader(C,N[C])}),U.upload.addEventListener("progress",l)}}).create((U,N)=>{if(s(C=>C-1),!U){let C={signedId:N.signed_id};h.type.includes("image")?C.path=mr(N.signed_id,N.filename):C.filename=N.filename;let F=e.files;F.push(C),e.onChange([...F])}})})}},E=u=>{if(!u.clipboardData)return;let h=u.clipboardData.items;if(h===void 0)return;let R=[];for(let U of h){if(e.accept&&!Object.keys(e.accept).some(C=>U.type.match(C)))continue;let N=U.getAsFile();N&&R.push(N)}p(R)},w=e.files.map(u=>T.createElement("div",{key:u.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},T.createElement("div",{className:"card-header p-1"},T.createElement("button",{onClick:h=>o(h,u.signedId||""),type:"button",className:"close","aria-label":"Close"},T.createElement("span",{"aria-hidden":"true"},"\xD7"))),T.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},T.createElement("img",{src:m.toBaseUrl(r,u.path||""),alt:u.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"})))),f=[];for(let u=0;u<i;u++)f.push(T.createElement("div",{key:u,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},T.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},T.createElement("div",{className:"p-4 text-center"},T.createElement("div",{className:"spinner-border",role:"status"},T.createElement("span",{className:"sr-only"},"Loading..."))))));let y=u=>{u.some(h=>h.errors[0].code===ie.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),u.some(h=>h.errors[0].code===ie.FileInvalidType)&&e.onInvalidTypeError(e.accept),u.some(h=>h.errors[0].code===ie.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return T.createElement("div",null,e.pasteZone&&T.createElement("input",{type:"text",className:`w-100 p-2 ${oe.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:E,readOnly:!0}),T.createElement(lr,{onDropAccepted:p,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:y,accept:e.accept},({getRootProps:u,getInputProps:h})=>T.createElement("section",null,T.createElement("div",{...u(),className:`${oe.dropzoneContainer} p-4 ${e.className}`},T.createElement("input",{...h()}),T.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),w.length>0?T.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},w):T.createElement("div",{className:"m-0"},e.customIcon||d),f.length>0&&T.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},f)))))};import{Formik as dr}from"formik";import M from"react-bootstrap/Form";import ur from"react-bootstrap/Button";import I,{useCallback as cr,useState as fr}from"react";import*as q from"yup";var gr=e=>{let{backendUrl:r,apiVersion:a}=x(),[n,i]=fr(!1),s=q.object().shape({password:q.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:q.string().oneOf([q.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.")}).defined(),d=cr(async o=>{i(!0);try{await c.passwordReset(r,{...o,resetPasswordToken:e.resetPasswordToken},a),await e.onResetPasswordSuccess()}catch(l){e.onResetPasswordError(l),i(!1)}},[e,r,a]);return I.createElement(dr,{initialValues:{password:"",passwordConfirmation:""},onSubmit:o=>{d(o)},validationSchema:s},({errors:o,handleChange:l,handleSubmit:p})=>I.createElement("form",{onSubmit:p,className:e.containerClassName||t.container},I.createElement(M.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},I.createElement(M.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),I.createElement(M.Control,{id:"password",type:"password",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!o.password}),I.createElement(M.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.password)),I.createElement(M.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},I.createElement(M.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),I.createElement(M.Control,{id:"passwordConfirmation",type:"password",onChange:l,className:e.fieldInputClassName||t.formField,isInvalid:!!o.passwordConfirmation}),I.createElement(M.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},o.passwordConfirmation)),!n&&I.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},I.createElement(ur,{variant:"primary",type:"submit",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit"))))};import he from"react";var pr=e=>{let{authInfo:r}=x();return he.createElement("div",null,r?e.children:he.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};import b,{useEffect as hr,useState as me}from"react";import*as _ from"yup";import{Formik as br}from"formik";import{Button as Er,Form as v}from"react-bootstrap";var Cr=e=>{let{authInfo:r,backendUrl:a,apiVersion:n}=x(),[i,s]=me(!1),[d,g]=me(null),[o,l]=me(void 0),p=f=>{g(f),l(f.unconfirmedEmail)};hr(()=>{(async()=>r&&p(await c.getUser(a,r,n)))()},[a,r,n]);let E=async f=>{if(r){s(!0);try{let y=await c.updateUser(a,f,r,n);e.onUserUpdateSuccess(y),p(y),s(!1)}catch(y){e.onUserUpdateError(y),s(!1)}}},w=_.object().shape({username:_.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:_.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:_.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:_.string().oneOf([_.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&b.createElement("div",{className:"ez-on-rails-form-outer-container"},d?b.createElement(br,{initialValues:d,validationSchema:w,enableReinitialize:!0,onSubmit:f=>{E(f)}},({errors:f,values:y,handleChange:u,setFieldValue:h,setFieldError:R,handleSubmit:U})=>b.createElement("form",{onSubmit:U,className:e.containerClassName||t.container},!e.hideUsername&&b.createElement(v.Group,{id:"username-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelUsername||"Username"),b.createElement(v.Control,{id:"username",className:e.fieldInputClassName||t.formField,type:"text",value:y.username,onChange:u,isInvalid:!!f.username}),b.createElement(v.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.username)),!e.hideEmail&&b.createElement(v.Group,{id:"email-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelEmail||"Email address"),b.createElement(v.Control,{id:"email",className:e.fieldInputClassName||t.formField,type:"email",value:y.email,onChange:u,isInvalid:!!f.email}),o&&b.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",o),b.createElement(v.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.email)),!e.hidePassword&&b.createElement(v.Group,{id:"password-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPassword||"Password"),b.createElement(v.Control,{id:"password",className:e.fieldInputClassName||t.formField,type:"password",value:y.password,onChange:u,isInvalid:!!f.password}),b.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),b.createElement(v.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.password)),!e.hidePassword&&b.createElement(v.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),b.createElement(v.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||t.formField,type:"password",value:y.passwordConfirmation,onChange:u,isInvalid:!!f.passwordConfirmation}),b.createElement(v.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.passwordConfirmation)),!e.hideAvatar&&b.createElement(v.Group,{id:"avatar-container",className:e.fieldContainerClassName||t.fieldContainer},b.createElement(v.Label,{className:e.fieldLabelClassName||t.fieldLabel},e.labelAvatar||"Avatar"),b.createElement("div",{className:e.dropzoneContainerClassName||t.formField},b.createElement(le,{onChange:N=>h("avatar",N.length>0?N[0]:null),files:y.avatar?[y.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>R("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>R("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>R("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),b.createElement(v.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||t.fieldError},f.avatar)),!i&&b.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},b.createElement(Er,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||t.submitButton},e.labelSubmitButton||"Submit")))):b.createElement("div",null,"Loading..."))};var be={fetcher:async([e,r,a="get",n=null,i=void 0,s="1.0"])=>{switch(a=a.toLowerCase(),a){case"post":return c.post(e,r,n,i,s);case"put":return c.put(e,r,n,i,s);case"patch":return c.patch(e,r,n,i,s);case"delete":return c.delete(e,r,n,i,s);default:return c.get(e,r,n,i,s)}}};var tt={client:c,swr:be,utils:m};import{AbstractUploader as Pr}from"@d4us1/remawy";import*as Ee from"@rails/activestorage";var de=class{constructor(r,a,n){this.uploader=r,this.authInfo=a,this.apiVersion=n}directUploadWillCreateBlobWithXHR(r){let a=c.defaultHttpHeader(this.authInfo,this.apiVersion);Object.keys(a).forEach(n=>{r.setRequestHeader(n,a[n])}),r.upload.addEventListener("progress",n=>this.uploader.onDirectUploadProgress(n))}},ee=class extends Pr{constructor(r,a,n){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=a,this.apiVersion=n}startUpload(r){let a=new de(this,this.authInfo,this.apiVersion);return new Ee.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,a).create((i,s)=>{if(i)this.onError(i);else{let d=`${this.baseUrl}rails/active_storage/blobs/${s.signed_id}/${s.filename}`,g={signedId:s.signed_id,fileName:s.filename};this.onFinish(d,r,g)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var Ce={uploader:ee};var gt={remawy:Ce};export{le as ActiveStorageDropzone,or as DevelopmentHint,ve as EzOnRails,tt as EzOnRailsHttp,V as EzOnRailsHttpError,gt as EzOnRailsIntegrations,Je as LoginForm,er as LostPasswordForm,pr as ProtectedPage,Ye as RegistrationForm,tr as ResendConfirmationForm,gr as ResetPasswordForm,Cr as UpdateUserForm,Me as useEzApi,ne as useEzApiHttpClient,x as useEzOnRails,De as useEzScaff};
//# sourceMappingURL=index.js.map
