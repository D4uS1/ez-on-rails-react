import xe,{useCallback as ve,useMemo as ze,useState as Y}from"react";import{createContext as we}from"react";var W=we({apiVersion:"1.0",backendUrl:"http://localhost:3000",authInfo:null,apiKey:null,setBackendUrl:e=>{},setAuthInfo:e=>{},setApiKey:e=>{},setApiVersion:e=>{},setOnUnauthorizedCallback:e=>{},setAdditionalHttpHeaders:e=>{}});var ye=e=>{let[r,n]=Y(e.backendUrl),[t,s]=Y(e.authInfo||null),[o,l]=Y(e.apiVersion),[m,b]=Y(e.apiKey||null),[i,u]=Y(()=>e.onUnauthorizedCallback),[p,N]=Y(e.additionalHttpHeaders),v=ve(h=>{u(()=>h)},[]),g=ze(()=>{let h={backendUrl:r,authInfo:t||null,apiKey:m||null,apiVersion:o,setBackendUrl:n,setAuthInfo:s,setApiKey:b,setApiVersion:l,setOnUnauthorizedCallback:v,onUnauthorizedCallback:i,additionalHttpHeaders:p,setAdditionalHttpHeaders:N};return h.backendUrl.endsWith("/")&&(h.backendUrl=h.backendUrl.slice(0,-1)),h},[r,t,m,o,v,i,p]);return xe.createElement(W.Provider,{value:g},e.children)};import T,{useState as Ye}from"react";import*as A from"yup";import{Formik as je}from"formik";import{useCallback as Ve,useEffect as De,useState as ie}from"react";import{useCallback as Me}from"react";import{toCamel as Re,toSnake as Fe}from"convert-keys";var G=class extends Error{constructor(r,n){super(),this.message=r,this.httpStatusCode=n}};var te=e=>e.startsWith("/")?e.slice(1):e,ae=e=>e.endsWith("/")?e.slice(0,-1):e,Ne=(e,r)=>`${ae(e)}/${te(r)}`,Oe=(e,r)=>`${ae(e)}/api/${te(r)}`,ke=e=>(e=e.replace(/[A-Z]/g,(r,n)=>n===0?r.toLowerCase():"_"+r.toLowerCase()),e=e.replace(/::_/g,"/"),e=e.replace(/\/_/g,"/"),e),ge=e=>e&&Fe(e),pe=e=>e&&Re(e),Se=e=>Object.keys(e).map(r=>r+"="+e[r]).join("&"),X=e=>typeof e=="string"&&/^\d{4}-\d{2}-\d{2}/.test(e)?new Date(e):Array.isArray(e)?e.map(r=>X(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=X(e[r])}),e),K=e=>{if(e instanceof Date)try{return e.toISOString()}catch(r){return console.error("ez-on-rails-react: Error converting date to iso string",r),null}return Array.isArray(e)?e.map(r=>K(r)):(e!==null&&typeof e=="object"&&Object.keys(e).forEach(r=>{e[r]=K(e[r])}),e)},Ue=e=>K(ge(e)),Ie=e=>!e||typeof e!="object"?e:X(pe(e)),Le=e=>e?e instanceof G:!1,d={cleanupUrl:ae,cleanupPath:te,toBaseUrl:Ne,toApiUrl:Oe,toSnakeCase:ge,toSnakeCasePath:ke,toCamelCase:pe,toGetParameters:Se,toDates:X,toDateStrings:K,toBackendParams:Ue,toFrontendParams:Ie,isEzOnRailsHttpError:Le};var Ae=e=>{if(e)return{uid:e.uid,client:e.client,expiry:e.expiry,"token-type":e.tokenType,"access-token":e.accessToken}},He=e=>{if(e)return{"api-key":e}},_e=e=>({uid:e.uid,client:e.client,expiry:e.expiry,tokenType:e["token-type"],accessToken:e["access-token"]}),F=(e,r,n,t)=>({"Content-Type":"application/json",Accept:"application/json","api-version":n,...He(r),...Ae(e),...t}),k=async(e,r,n,t)=>{let s=await fetch(r,{method:e,headers:t,body:n?JSON.stringify(n):null});if(!s.ok)throw new G(await s.text(),s.status);let o={},l=null;try{s.headers.forEach((m,b)=>{o[b]=m}),l=await s.json()}catch{}return{headers:o,body:l}},f={signUp:async(e,r,n,t)=>{r=d.toBackendParams(r),await k("POST",d.toBaseUrl(e,"users"),{user:r},F(null,null,n,t))},signIn:async(e,r,n,t)=>{r=d.toBackendParams(r);let s=await k("POST",d.toApiUrl(e,"auth/sign_in"),r,F(null,null,n,t));return _e(s.headers)},signOut:async(e,r,n,t)=>{await k("DELETE",d.toApiUrl(e,"auth/sign_out"),null,F(r,null,n,t))},passwordResetInstructions:async(e,r,n,t)=>{r=d.toBackendParams(r),await k("POST",d.toBaseUrl(e,"users/password"),{user:r},F(null,null,n,t))},passwordReset:async(e,r,n,t)=>{r=d.toBackendParams(r),await k("PUT",d.toBaseUrl(e,"users/password"),{user:r},F(null,null,n,t))},getUser:async(e,r,n,t)=>{let s=await k("GET",d.toApiUrl(e,"users/me"),null,F(r,null,n,t));return d.toFrontendParams(s.body)},updateUser:async(e,r,n,t,s)=>{let o=r.avatar?.signedId,l={...d.toBackendParams(r),avatar:o},m=await k("PATCH",d.toApiUrl(e,"users/me"),{user:l},F(n,null,t,s));return d.toFrontendParams(m.body)},confirmationInstructions:async(e,r,n,t)=>{r=d.toBackendParams(r),await k("POST",d.toBaseUrl(e,"users/confirmation"),{user:r},F(null,null,n,t))},confirmation:async(e,r,n,t)=>{let s=d.toBaseUrl(e,"users/confirmation");r=d.toBackendParams(r),s=`${s}?${d.toGetParameters(r)}`,await k("GET",s,null,F(null,null,n,t))},get:async(e,r,n,t=null,s=null,o="1.0",l=void 0,m)=>{let b=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(b=`${b}?${d.toGetParameters(n)}`);let i=await k("GET",b,null,F(t,s,o,m));return d.toFrontendParams(i.body)},post:async(e,r,n,t=null,s=null,o="1.0",l=void 0,m)=>{let b=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let i=await k("POST",b,n,F(t,s,o,m));return d.toFrontendParams(i.body)},patch:async(e,r,n,t=null,s=null,o="1.0",l=void 0,m)=>{let b=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let i=await k("PATCH",b,n,F(t,s,o,m));return d.toFrontendParams(i.body)},put:async(e,r,n,t=null,s=null,o="1.0",l=void 0,m)=>{let b=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n));let i=await k("PUT",b,n,F(t,s,o,m));return d.toFrontendParams(i.body)},delete:async(e,r,n,t=null,s=null,o="1.0",l=void 0,m)=>{let b=d.toApiUrl(e,r);n&&(n=d.toBackendParams(n)),l&&(n=l(n)),n&&(b=`${b}?${d.toGetParameters(n)}`);let i=await k("DELETE",b,null,F(t,s,o,m));return d.toFrontendParams(i.body)},defaultHttpHeader:(e,r,n,t)=>F(e,r,n,t)};import{useContext as Be}from"react";var x=()=>Be(W);var se=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,onUnauthorizedCallback:o,additionalHttpHeaders:l}=x();return{call:Me(async(b,i,u)=>{let p=e?d.cleanupPath(d.cleanupUrl(e)):null,N=d.cleanupPath(b),v=`${p?p+"/":""}${N}`;try{switch(i){case"POST":return await f.post(r,v,u,n,t,s,void 0,l);case"PUT":return await f.put(r,v,u,n,t,s,void 0,l);case"PATCH":return await f.patch(r,v,u,n,t,s,void 0,l);case"DELETE":return await f.delete(r,v,u,n,t,s,void 0,l);default:return await f.get(r,v,u,n,t,s,void 0,l)}}catch(g){if(!d.isEzOnRailsHttpError(g)||g.httpStatusCode!==401||!o)throw g;return o(),null}},[n,t,s,r,e,o])}};var qe=(e,r="GET",n,t)=>{let[s,o]=ie(null),[l,m]=ie(null),[b,i]=ie(!1),{call:u}=se(),p=Ve(async N=>{try{i(!0),m(null),o(null);let v=await u(e,r,N||n);return o(v),i(!1),v}catch(v){m(v),i(!1)}},[e,u,n,r]);return De(()=>{(async()=>t?.skipInitialCall||await p())()},[p,t]),{data:s,error:l,inProgress:b,callApi:p}};import{useCallback as $,useMemo as Ge,useState as J}from"react";var $e=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,additionalHttpHeaders:o}=x(),[l,m]=J(null),[b,i]=J(null),[u,p]=J(!1),[N,v]=J(null),g=Ge(()=>d.toSnakeCasePath(e),[e]),h=$(async P=>{v(null),p(!0);try{let R=await P();return p(!1),R}catch(R){return p(!1),v(R),null}},[]),B=$(()=>h(async()=>{let P=await f.get(r,g,null,n,t,s,void 0,o);return i(P),P}),[r,n,t,s,g,h]),c=$(P=>h(async()=>{let R=await f.get(r,`${g}/${P}`,null,n,t,s,void 0,o);return m(R),R}),[r,n,t,s,g,h]),E=$(P=>h(async()=>{let R=await f.post(r,`${g}/search`,P,n,t,s,void 0,o);return i(R),R}),[r,n,t,s,g,h]),U=$(P=>h(async()=>{let R=await f.post(r,g,P,n,t,s,void 0,o);return m(R),R}),[r,n,t,s,g,h]),O=$((P,R)=>h(async()=>{let fe=await f.patch(r,`${g}/${P}`,R,n,t,s,void 0,o);return m(fe),fe}),[r,n,t,s,g,h]),I=$(P=>h(async()=>{await f.delete(r,`${g}/${P}`,null,n,t,s,void 0,o),m(null)}),[r,n,t,s,g,h]);return{record:l,records:b,inProgress:u,error:N,getAll:B,getOne:c,search:E,create:U,update:O,remove:I}};import{Button as We,Form as y}from"react-bootstrap";var a={container:"Form-module__container_7Xp4fa__121",fieldContainer:"Form-module__fieldContainer_7Xp4fa__121",fieldLabel:"Form-module__fieldLabel_7Xp4fa__121"};var Xe=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=x(),[s,o]=Ye(!1),l=async i=>{o(!0);try{await f.signUp(r,i,n,t),e.onRegisterSuccess(i.email),o(!1)}catch(u){e.onRegisterError(u),o(!1)}},m=A.object().shape({username:A.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must not have more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:A.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must have not more than ${e.maxEmailLength||100} characters.`),password:A.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:A.string().oneOf([A.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation must match.").required(e.passwordsMustMatchErrorText||"The password and its confirmation must match."),privacyPolicyAccepted:A.boolean().isTrue(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.").required(e.privacyPolicyNotAcceptedErrorText||"The privacy policy must be accepted.")}).defined();return T.createElement(je,{initialValues:{username:"",email:"",password:"",passwordConfirmation:"",privacyPolicyAccepted:!1},validationSchema:m,onSubmit:i=>{l(i)}},({errors:i,handleChange:u,handleSubmit:p})=>T.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},T.createElement(y.Group,{id:"username-container",className:e.fieldContainerClassName||a.fieldContainer},T.createElement(y.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelUsername||"Username"),T.createElement(y.Control,{id:"username",className:e.fieldInputClassName||a.formField,type:"text",onChange:u,isInvalid:!!i.username}),T.createElement(y.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},i.username)),T.createElement(y.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},T.createElement(y.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),T.createElement(y.Control,{id:"email",className:e.fieldInputClassName||a.formField,type:"email",onChange:u,isInvalid:!!i.email}),T.createElement(y.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},i.email)),T.createElement(y.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},T.createElement(y.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),T.createElement(y.Control,{id:"password",className:e.fieldInputClassName||a.formField,type:"password",onChange:u,isInvalid:!!i.password}),T.createElement(y.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},i.password)),T.createElement(y.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},T.createElement(y.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),T.createElement(y.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||a.formField,type:"password",onChange:u,isInvalid:!!i.passwordConfirmation}),T.createElement(y.Control.Feedback,{className:e.fieldErrorClassName||a.fieldError,type:"invalid"},i.passwordConfirmation)),T.createElement(y.Group,{id:"privacy-policy-accepted-container",className:e.fieldCheckboxContainerClassName||a.fieldContainer},T.createElement(y.Check,{id:"privacyPolicyAccepted",className:e.fieldCheckboxInputClassName||a.formField,type:"checkbox",label:e.labelPrivacyPolicyAccepted||T.createElement("span",null,"I have read and accept the"," ",T.createElement("a",{href:e.privacyPolicyUrl,target:"_blank",rel:"noopener noreferrer"},"privacy policy")," ","and"," ",T.createElement("a",{href:e.generalTermsUrl,target:"_blank",rel:"noopener noreferrer"},"terms and conditions")," ","."),onChange:u,isInvalid:!!i.privacyPolicyAccepted,feedbackType:"invalid",feedback:i.privacyPolicyAccepted})),!s&&T.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},T.createElement(We,{className:e.submitButtonClassName||a.submitButton,type:"submit",variant:"primary"},e.labelSubmitButton||"Register"))))};import{Formik as Ke}from"formik";import H from"react-bootstrap/Form";import Je from"react-bootstrap/Button";import S,{useState as Ze}from"react";import*as j from"yup";var Qe=e=>{let{backendUrl:r,apiVersion:n,setAuthInfo:t,additionalHttpHeaders:s}=x(),[o,l]=Ze(!1),m=j.object().shape({email:j.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required."),password:j.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"The password is required.")}).defined(),b=async u=>{l(!0);try{let p=await f.signIn(r,u,n,s);if(!p)throw"No authentication object returned";if(t(p),!e.onLoginSuccess)return;await e.onLoginSuccess(u.email,p,u.stayLoggedIn)}catch(p){e.onLoginError(p),l(!1)}};return S.createElement(Ke,{initialValues:{email:"",password:"",stayLoggedIn:!1},onSubmit:u=>{b(u)},validationSchema:m},({errors:u,handleChange:p,handleSubmit:N})=>S.createElement("form",{onSubmit:N,className:e.containerClassName||a.container},S.createElement(H.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},S.createElement(H.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),S.createElement(H.Control,{id:"email",type:"email",onChange:p,className:e.fieldInputClassName||a.formField,isInvalid:!!u.email}),S.createElement(H.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},u.email)),S.createElement(H.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},S.createElement(H.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),S.createElement(H.Control,{id:"password",type:"password",onChange:p,className:e.fieldInputClassName||a.formField,isInvalid:!!u.password}),S.createElement(H.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},u.password)),!e.hideStayLoggedIn&&S.createElement(H.Group,{id:"stay-logged-in-container",className:e.fieldCheckboxContainerClassName||a.fieldContainer},S.createElement(H.Check,{id:"stayLoggedIn",className:e.fieldCheckboxInputClassName||a.formField,type:"checkbox",label:e.labelStayLoggedIn||"Stay logged in.",onChange:p})),!o&&S.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},S.createElement(Je,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Login"))))};import M,{useState as er}from"react";import*as Q from"yup";import{Formik as rr}from"formik";import Z from"react-bootstrap/Form";import nr from"react-bootstrap/Button";var tr=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=x(),[s,o]=er(!1),l=Q.object().shape({email:Q.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"The email address is required.")}).defined(),m=i=>{o(!0),f.passwordResetInstructions(r,i,n,t).then(()=>{e.onLostPasswordSuccess(i.email),o(!1)}).catch(u=>{e.onLostPasswordError(u),o(!1)})};return M.createElement(rr,{initialValues:{email:""},onSubmit:i=>{m(i)},validationSchema:l},({errors:i,handleChange:u,handleSubmit:p})=>M.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},M.createElement(Z.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},M.createElement(Z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),M.createElement(Z.Control,{id:"email",type:"email",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!i.email}),M.createElement(Z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},i.email)),!s&&M.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},M.createElement(nr,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};import V,{useState as ar}from"react";import*as re from"yup";import{Formik as sr}from"formik";import ee from"react-bootstrap/Form";import ir from"react-bootstrap/Button";var or=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=x(),[s,o]=ar(!1),l=re.object().shape({email:re.string().email(e.invalidEmailErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.")}).defined(),m=i=>{o(!0),f.confirmationInstructions(r,i,n,t).then(()=>{e.onResendConfirmationSuccess(i.email),o(!1)}).catch(u=>{e.onResendConfirmationError(u),o(!1)})};return V.createElement(sr,{initialValues:{email:""},onSubmit:i=>{m(i)},validationSchema:l},({errors:i,handleChange:u,handleSubmit:p})=>V.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},V.createElement(ee.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},V.createElement(ee.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),V.createElement(ee.Control,{id:"email",type:"email",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!i.email}),V.createElement(ee.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},i.email)),!s&&V.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},V.createElement(ir,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};import he,{useState as lr}from"react";var oe={container:"DevelopmentHint-module__container_wJV76G__121",text:"DevelopmentHint-module__text_wJV76G__121"};var mr=e=>{let[r,n]=lr(e.visible),t=()=>{n(!0)};return r?he.createElement("div",{onClick:()=>{n(!1),setTimeout(t,e.dismissTimeout||2e4)},className:oe.container},he.createElement("span",{className:oe.text},"development")):null};import w from"react";import*as be from"@rails/activestorage";import{useState as dr}from"react";import ur,{ErrorCode as me}from"react-dropzone";var le={dropzoneContainer:"ActiveStorageDropzone-module__dropzoneContainer_Xe818a__121",pastezoneContainer:"ActiveStorageDropzone-module__pastezoneContainer_Xe818a__121"};var cr=(e,r)=>`rails/active_storage/blobs/${e}/${r}`,de=e=>{let{backendUrl:r,authInfo:n,apiKey:t,apiVersion:s,additionalHttpHeaders:o}=x(),[l,m]=dr(0),b=w.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",fill:"currentColor",className:"bi bi-cloud-arrow-up",viewBox:"0 0 16 16"},w.createElement("path",{fillRule:"evenodd",d:"M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z"}),w.createElement("path",{d:"M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z"})),i=async c=>{await f.delete(r,`active_storage/blobs/${c}`,null,n,t,s,void 0,o)},u=async(c,E)=>{await i(E);let U=[...e.files];U=U.filter(O=>E!==O.signedId),e.onChange(U),c.stopPropagation(),c.preventDefault()},p=c=>{c.loaded/c.total>=.9999999},N=c=>{if(c.length){if(e.maxFiles){let E=e.maxFiles-(e.files.length+l);if(E<c.length&&e.onMaxFilesError(e.maxFiles),E<=0)return;c=c.slice(0,E)}if(e.maxSize){let E=c.filter(U=>U.size<=e.maxSize);E.length<c.length&&e.onMaxSizeError(e.maxSize),c=E}m(E=>E+c.length),c.forEach(E=>{new be.DirectUpload(E,d.toApiUrl(r,"active_storage/blobs/create_direct_upload"),{directUploadWillCreateBlobWithXHR:O=>{let I=f.defaultHttpHeader(n,t,s);Object.keys(I).forEach(P=>{O.setRequestHeader(P,I[P])}),O.upload.addEventListener("progress",p)}}).create((O,I)=>{if(m(P=>P-1),!O){let P={signedId:I.signed_id};E.type.includes("image")?P.path=cr(I.signed_id,I.filename):P.filename=I.filename;let R=e.files;R.push(P),e.onChange([...R])}})})}},v=c=>{if(!c.clipboardData)return;let E=c.clipboardData.items;if(E===void 0)return;let U=[];for(let O of E){if(e.accept&&!Object.keys(e.accept).some(P=>O.type.match(P)))continue;let I=O.getAsFile();I&&U.push(I)}N(U)},g=e.files.map(c=>w.createElement("div",{key:c.signedId,className:"card w-25 animate__animated animate__fadeIn mb-4",style:{flex:"0 0 auto"}},w.createElement("div",{className:"card-header p-1"},w.createElement("button",{onClick:E=>u(E,c.signedId||""),type:"button",className:"close","aria-label":"Close"},w.createElement("span",{"aria-hidden":"true"},"\xD7"))),w.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.createElement("img",{src:d.toBaseUrl(r,c.path||""),alt:c.filename,className:"d-block mw-100 m-auto m-0 rounded p-1"})))),h=[];for(let c=0;c<l;c++)h.push(w.createElement("div",{key:c,className:"card w-25 mb-4",style:{flex:"0 0 auto"}},w.createElement("div",{className:"d-flex justify-content-center align-items-center w-100 h-100"},w.createElement("div",{className:"p-4 text-center"},w.createElement("div",{className:"spinner-border",role:"status"},w.createElement("span",{className:"sr-only"},"Loading..."))))));let B=c=>{c.some(E=>E.errors[0].code===me.TooManyFiles)&&e.onMaxFilesError(e.maxFiles),c.some(E=>E.errors[0].code===me.FileInvalidType)&&e.onInvalidTypeError(e.accept),c.some(E=>E.errors[0].code===me.FileTooLarge)&&e.onMaxSizeError(e.maxSize)};return w.createElement("div",null,e.pasteZone&&w.createElement("input",{type:"text",className:`w-100 p-2 ${le.pastezoneContainer}`,value:e.textPastezone||"Copy and paste some files here",onPaste:v,readOnly:!0}),w.createElement(ur,{onDropAccepted:N,multiple:e.multiple,maxFiles:e.maxFiles,maxSize:e.maxSize,onDropRejected:B,accept:e.accept},({getRootProps:c,getInputProps:E})=>w.createElement("section",null,w.createElement("div",{...c(),className:`${le.dropzoneContainer} p-4 ${e.className}`},w.createElement("input",{...E()}),w.createElement("p",{className:"m-0"},e.textDropzone||"Drag 'n' drop some files here, or click to select files"),g.length>0?w.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},g):w.createElement("div",{className:"m-0"},e.customIcon||b),h.length>0&&w.createElement("aside",{className:"card-deck justify-content-center w-100 m-4"},h)))))};import{Formik as fr}from"formik";import D from"react-bootstrap/Form";import gr from"react-bootstrap/Button";import L,{useCallback as pr,useState as hr}from"react";import*as q from"yup";var br=e=>{let{backendUrl:r,apiVersion:n,additionalHttpHeaders:t}=x(),[s,o]=hr(!1),l=q.object().shape({password:q.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`).required(e.passwordRequiredErrorText||"A password is required."),passwordConfirmation:q.string().oneOf([q.ref("password")],e.passwordConfirmationMatchErrorText||"The password and its confirmation must match.").required(e.passwordConfirmationMatchErrorText||"The password and its confirmation must match."),resetPasswordToken:q.string().required("")}).defined(),m=pr(async i=>{o(!0);try{await f.passwordReset(r,{...i,resetPasswordToken:e.resetPasswordToken},n,t),await e.onResetPasswordSuccess()}catch(u){e.onResetPasswordError(u),o(!1)}},[e,r,n]);return L.createElement(fr,{initialValues:{password:"",passwordConfirmation:""},onSubmit:i=>{m(i)},validationSchema:l},({errors:i,handleChange:u,handleSubmit:p})=>L.createElement("form",{onSubmit:p,className:e.containerClassName||a.container},L.createElement(D.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},L.createElement(D.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),L.createElement(D.Control,{id:"password",type:"password",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!i.password}),L.createElement(D.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},i.password)),L.createElement(D.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},L.createElement(D.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),L.createElement(D.Control,{id:"passwordConfirmation",type:"password",onChange:u,className:e.fieldInputClassName||a.formField,isInvalid:!!i.passwordConfirmation}),L.createElement(D.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},i.passwordConfirmation)),!s&&L.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},L.createElement(gr,{variant:"primary",type:"submit",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit"))))};import Ee from"react";var Er=e=>{let{authInfo:r}=x();return Ee.createElement("div",null,r?e.children:Ee.createElement("div",{className:e.accessDeniedClassName||"ez-on-rails-protected-page-access-denied-container"},e.accessDeniedText||"You must be signed in to see this content."))};import C,{useEffect as Cr,useState as ue}from"react";import*as _ from"yup";import{Formik as Pr}from"formik";import{Button as Tr,Form as z}from"react-bootstrap";var wr=e=>{let{authInfo:r,backendUrl:n,apiVersion:t,additionalHttpHeaders:s}=x(),[o,l]=ue(!1),[m,b]=ue(null),[i,u]=ue(void 0),p=g=>{b(g),u(g.unconfirmedEmail)};Cr(()=>{(async()=>r&&p(await f.getUser(n,r,t,s)))()},[n,r,t]);let N=async g=>{if(r){l(!0);try{let h=await f.updateUser(n,g,r,t,s);e.onUserUpdateSuccess(h),p(h),l(!1)}catch(h){e.onUserUpdateError(h),l(!1)}}},v=_.object().shape({username:_.string().min(e.minUsernameLength||5,e.usernameToShortErrorText||`The username is too short. It must have at least ${e.minUsernameLength||5} characters.`).max(e.maxUsernameLength||50,e.usernameToLongErrorText||`The username is too long. It must have not more than ${e.maxUsernameLength||50} characters.`).required(e.usernameRequiredErrorText||"An username is required."),email:_.string().email(e.emailInvalidErrorText||"Invalid email address.").required(e.emailRequiredErrorText||"An email address is required.").max(e.maxEmailLength||100,e.emailToLongErrorText||`The email address is too long. It must not have more than ${e.maxEmailLength||100} characters.`),password:_.string().min(e.minPasswordLength||8,e.passwordToShortErrorText||`The password is too short. It must have at least ${e.minPasswordLength||8} characters.`),passwordConfirmation:_.string().oneOf([_.ref("password")],e.passwordsMustMatchErrorText||"The password and its confirmation do not match.")}).defined();return r&&C.createElement("div",{className:"ez-on-rails-form-outer-container"},m?C.createElement(Pr,{initialValues:m,validationSchema:v,enableReinitialize:!0,onSubmit:g=>{N(g)}},({errors:g,values:h,handleChange:B,setFieldValue:c,setFieldError:E,handleSubmit:U})=>C.createElement("form",{onSubmit:U,className:e.containerClassName||a.container},!e.hideUsername&&C.createElement(z.Group,{id:"username-container",className:e.fieldContainerClassName||a.fieldContainer},C.createElement(z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelUsername||"Username"),C.createElement(z.Control,{id:"username",className:e.fieldInputClassName||a.formField,type:"text",value:h.username,onChange:B,isInvalid:!!g.username}),C.createElement(z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.username)),!e.hideEmail&&C.createElement(z.Group,{id:"email-container",className:e.fieldContainerClassName||a.fieldContainer},C.createElement(z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelEmail||"Email address"),C.createElement(z.Control,{id:"email",className:e.fieldInputClassName||a.formField,type:"email",value:h.email,onChange:B,isInvalid:!!g.email}),i&&C.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-unconfirmed-email-text"},e.unconfirmedEmailText||"The following email is not yet confirmed: "," ",i),C.createElement(z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.email)),!e.hidePassword&&C.createElement(z.Group,{id:"password-container",className:e.fieldContainerClassName||a.fieldContainer},C.createElement(z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPassword||"Password"),C.createElement(z.Control,{id:"password",className:e.fieldInputClassName||a.formField,type:"password",value:h.password,onChange:B,isInvalid:!!g.password}),C.createElement("div",{className:e.fieldInfoClassName||"ez-on-rails-password-optional-text"},e.passwordChangeOptionalText||"You must only provide this if you want to change the password."),C.createElement(z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.password)),!e.hidePassword&&C.createElement(z.Group,{id:"password-confirmation-container",className:e.fieldContainerClassName||a.fieldContainer},C.createElement(z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelPasswordConfirmation||"Password confirmation"),C.createElement(z.Control,{id:"passwordConfirmation",className:e.fieldInputClassName||a.formField,type:"password",value:h.passwordConfirmation,onChange:B,isInvalid:!!g.passwordConfirmation}),C.createElement(z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.passwordConfirmation)),!e.hideAvatar&&C.createElement(z.Group,{id:"avatar-container",className:e.fieldContainerClassName||a.fieldContainer},C.createElement(z.Label,{className:e.fieldLabelClassName||a.fieldLabel},e.labelAvatar||"Avatar"),C.createElement("div",{className:e.dropzoneContainerClassName||a.formField},C.createElement(de,{onChange:O=>c("avatar",O.length>0?O[0]:null),files:h.avatar?[h.avatar]:[],multiple:!1,maxFiles:1,onMaxFilesError:()=>E("avatar",e.avatarToManyFilesErrorText||"Only one file is allowed"),maxSize:e.avatarMaxSize||5242880,onMaxSizeError:()=>E("avatar",e.avatarToLargeErrorText||`The file must not be larger than ${Math.round((e.avatarMaxSize||5242880)/1048576)} MB.`),onInvalidTypeError:()=>E("avatar",e.avatarWrongFormatErrorText||"Invalid file format.")})),C.createElement(z.Control.Feedback,{type:"invalid",className:e.fieldErrorClassName||a.fieldError},g.avatar)),!o&&C.createElement("div",{className:e.submitButtonContainerClassName||"ez-on-rails-form-submit-container"},C.createElement(Tr,{ref:e.submitRef,type:"submit",variant:"primary",className:e.submitButtonClassName||a.submitButton},e.labelSubmitButton||"Submit")))):C.createElement("div",null,"Loading..."))};var Ce={fetcher:async([e,r,n="get",t=null,s=void 0,o=null,l="1.0",m=void 0])=>{switch(n=n.toLowerCase(),n){case"post":return f.post(e,r,t,s,o,l,void 0,m);case"put":return f.put(e,r,t,s,o,l,void 0,m);case"patch":return f.patch(e,r,t,s,o,l,void 0,m);case"delete":return f.delete(e,r,t,s,o,l,void 0,m);default:return f.get(e,r,t,s,o,l,void 0,m)}}};var oa={client:f,swr:Ce,utils:d};import{AbstractUploader as xr}from"@d4us1/remawy";import*as Pe from"@rails/activestorage";var ce=class{constructor(r,n,t){this.uploader=r,this.authInfo=n,this.apiVersion=t}directUploadWillCreateBlobWithXHR(r){let n=f.defaultHttpHeader(this.authInfo,null,this.apiVersion);Object.keys(n).forEach(t=>{r.setRequestHeader(t,n[t])}),r.upload.addEventListener("progress",t=>this.uploader.onDirectUploadProgress(t))}},ne=class extends xr{constructor(r,n,t){super(),r.endsWith("/")||(r=`${r}/`),this.baseUrl=r,this.authInfo=n,this.apiVersion=t}startUpload(r){let n=new ce(this,this.authInfo,this.apiVersion);return new Pe.DirectUpload(r,`${this.baseUrl}api/active_storage/blobs/create_direct_upload`,n).create((s,o)=>{if(s)this.onError(s);else{let l=`${this.baseUrl}rails/active_storage/blobs/${o.signed_id}/${o.filename}`,m={signedId:o.signed_id,fileName:o.filename};this.onFinish(l,r,m)}}),Promise.resolve(void 0)}onDirectUploadProgress(r){this.onProgress(r.loaded/r.total)}};var Te={uploader:ne};var ba={remawy:Te};export{de as ActiveStorageDropzone,mr as DevelopmentHint,ye as EzOnRails,oa as EzOnRailsHttp,G as EzOnRailsHttpError,ba as EzOnRailsIntegrations,Qe as LoginForm,tr as LostPasswordForm,Er as ProtectedPage,Xe as RegistrationForm,or as ResendConfirmationForm,br as ResetPasswordForm,wr as UpdateUserForm,qe as useEzApi,se as useEzApiHttpClient,x as useEzOnRails,$e as useEzScaff};
//# sourceMappingURL=index.js.map
